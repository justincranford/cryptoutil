// Package server provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package server

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"
	"time"

	"github.com/getkin/kin-openapi/openapi3"
	"github.com/gofiber/fiber/v2"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "bearerAuth.Scopes"
)

// Defines values for CertificateStatus.
const (
	CertificateStatusActive  CertificateStatus = "active"
	CertificateStatusExpired CertificateStatus = "expired"
	CertificateStatusRevoked CertificateStatus = "revoked"
)

// Defines values for EnrollmentPendingResponseStatus.
const (
	EnrollmentPendingResponseStatusPending EnrollmentPendingResponseStatus = "pending"
)

// Defines values for EnrollmentResponseStatus.
const (
	Issued EnrollmentResponseStatus = "issued"
)

// Defines values for EnrollmentStatusResponseStatus.
const (
	EnrollmentStatusResponseStatusApproved EnrollmentStatusResponseStatus = "approved"
	EnrollmentStatusResponseStatusIssued   EnrollmentStatusResponseStatus = "issued"
	EnrollmentStatusResponseStatusPending  EnrollmentStatusResponseStatus = "pending"
	EnrollmentStatusResponseStatusRejected EnrollmentStatusResponseStatus = "rejected"
)

// Defines values for ProfileSummaryCategory.
const (
	CA              ProfileSummaryCategory = "ca"
	CodeSigning     ProfileSummaryCategory = "code_signing"
	DocumentSigning ProfileSummaryCategory = "document_signing"
	Email           ProfileSummaryCategory = "email"
	Other           ProfileSummaryCategory = "other"
	TLS             ProfileSummaryCategory = "tls"
)

// Defines values for RevocationReason.
const (
	AaCompromise         RevocationReason = "aa_compromise"
	AffiliationChanged   RevocationReason = "affiliation_changed"
	CACompromise         RevocationReason = "ca_compromise"
	CertificateHold      RevocationReason = "certificate_hold"
	CessationOfOperation RevocationReason = "cessation_of_operation"
	KeyCompromise        RevocationReason = "key_compromise"
	PrivilegeWithdrawn   RevocationReason = "privilege_withdrawn"
	RemoveFromCRL        RevocationReason = "remove_from_crl"
	Superseded           RevocationReason = "superseded"
	Unspecified          RevocationReason = "unspecified"
)

// Defines values for RevocationResponseStatus.
const (
	RevocationResponseStatusRevoked RevocationResponseStatus = "revoked"
)

// CertificateChainResponse defines model for CertificateChainResponse.
type CertificateChainResponse struct {
	// Certificates Chain certificates from leaf to root
	Certificates []ChainCertificate `json:"certificates"`
}

// CertificateListResponse defines model for CertificateListResponse.
type CertificateListResponse struct {
	Certificates []CertificateSummary `json:"certificates"`

	// Page Current page number
	Page int `json:"page"`

	// PageSize Number of results per page
	PageSize int `json:"page_size"`

	// Total Total number of matching certificates
	Total int `json:"total"`
}

// CertificateResponse defines model for CertificateResponse.
type CertificateResponse struct {
	CertificatePEM    string              `json:"certificate_pem"`
	FingerprintSha256 *string             `json:"fingerprint_sha256,omitempty"`
	Issuer            *CertificateSubject `json:"issuer,omitempty"`
	NotAfter          *time.Time          `json:"not_after,omitempty"`
	NotBefore         *time.Time          `json:"not_before,omitempty"`
	Profile           *string             `json:"profile,omitempty"`

	// RevocationReason Reason for revocation (if revoked)
	RevocationReason *string `json:"revocation_reason,omitempty"`

	// RevocationTime Time of revocation (if revoked)
	RevocationTime *time.Time `json:"revocation_time,omitempty"`
	SerialNumber   string     `json:"serial_number"`

	// Status Certificate status
	Status  CertificateStatus   `json:"status"`
	Subject *CertificateSubject `json:"subject,omitempty"`
}

// CertificateStatus Certificate status
type CertificateStatus string

// CertificateSubject defines model for CertificateSubject.
type CertificateSubject struct {
	CommonName         *string   `json:"common_name,omitempty"`
	Country            *[]string `json:"country,omitempty"`
	DNSNames           *[]string `json:"dns_names,omitempty"`
	EmailAddresses     *[]string `json:"email_addresses,omitempty"`
	IPAddresses        *[]string `json:"ip_addresses,omitempty"`
	Locality           *[]string `json:"locality,omitempty"`
	Organization       *[]string `json:"organization,omitempty"`
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`
	State              *[]string `json:"state,omitempty"`
}

// CertificateSummary defines model for CertificateSummary.
type CertificateSummary struct {
	NotAfter     *time.Time `json:"not_after,omitempty"`
	NotBefore    *time.Time `json:"not_before,omitempty"`
	Profile      *string    `json:"profile,omitempty"`
	SerialNumber string     `json:"serial_number"`

	// Status Certificate status
	Status    CertificateStatus `json:"status"`
	SubjectCN string            `json:"subject_cn"`
}

// ChainCertificate defines model for ChainCertificate.
type ChainCertificate struct {
	CertificatePEM string              `json:"certificate_pem"`
	IsCA           *bool               `json:"is_ca,omitempty"`
	Issuer         *CertificateSubject `json:"issuer,omitempty"`
	Subject        CertificateSubject  `json:"subject"`
}

// EnrollmentPendingResponse defines model for EnrollmentPendingResponse.
type EnrollmentPendingResponse struct {
	// EstimatedCompletion Estimated time for approval
	EstimatedCompletion *time.Time `json:"estimated_completion,omitempty"`

	// Message Additional status information
	Message *string `json:"message,omitempty"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentPendingResponseStatus `json:"status"`
}

// EnrollmentPendingResponseStatus Enrollment status
type EnrollmentPendingResponseStatus string

// EnrollmentRequest defines model for EnrollmentRequest.
type EnrollmentRequest struct {
	// CSR Certificate Signing Request in PEM format. Must begin with "-----BEGIN CERTIFICATE REQUEST-----" and end with "-----END CERTIFICATE REQUEST-----".
	CSR string `json:"csr"`

	// Profile Certificate profile identifier to use for issuance
	Profile string `json:"profile"`

	// SANOverride Optional Subject Alternative Name overrides
	SANOverride *SANOverride `json:"san_override,omitempty"`

	// SubjectOverride Optional subject DN field overrides
	SubjectOverride *SubjectOverride `json:"subject_override,omitempty"`

	// ValidityDays Requested validity period in days (may be truncated by profile)
	ValidityDays *int `json:"validity_days,omitempty"`
}

// EnrollmentResponse defines model for EnrollmentResponse.
type EnrollmentResponse struct {
	Certificate IssuedCertificate `json:"certificate"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentResponseStatus `json:"status"`
}

// EnrollmentResponseStatus Enrollment status
type EnrollmentResponseStatus string

// EnrollmentStatusResponse defines model for EnrollmentStatusResponse.
type EnrollmentStatusResponse struct {
	Certificate *IssuedCertificate `json:"certificate,omitempty"`

	// RejectionReason Reason for rejection (if status is rejected)
	RejectionReason *string                        `json:"rejection_reason,omitempty"`
	RequestID       openapi_types.UUID             `json:"request_id"`
	Status          EnrollmentStatusResponseStatus `json:"status"`
	SubmittedAt     *time.Time                     `json:"submitted_at,omitempty"`
	UpdatedAt       *time.Time                     `json:"updated_at,omitempty"`
}

// EnrollmentStatusResponseStatus defines model for EnrollmentStatusResponse.Status.
type EnrollmentStatusResponseStatus string

// ErrorDetail defines model for ErrorDetail.
type ErrorDetail struct {
	// Field Field that caused the error
	Field *string `json:"field,omitempty"`

	// Message Error description
	Message *string `json:"message,omitempty"`
}

// ErrorResponse defines model for ErrorResponse.
type ErrorResponse struct {
	Details *[]ErrorDetail `json:"details,omitempty"`

	// Error Error code
	Error string `json:"error"`

	// Message Human-readable error message
	Message *string `json:"message,omitempty"`
}

// IssuedCertificate defines model for IssuedCertificate.
type IssuedCertificate struct {
	// CertificatePEM Certificate in PEM format
	CertificatePEM string `json:"certificate_pem"`

	// ChainPEM Full certificate chain in PEM format (excluding root)
	ChainPEM *string `json:"chain_pem,omitempty"`

	// FingerprintSha256 SHA-256 fingerprint of the certificate
	FingerprintSha256 *string `json:"fingerprint_sha256,omitempty"`

	// NotAfter Certificate validity end time
	NotAfter time.Time `json:"not_after"`

	// NotBefore Certificate validity start time
	NotBefore time.Time `json:"not_before"`

	// SerialNumber Certificate serial number (hex-encoded)
	SerialNumber string              `json:"serial_number"`
	Subject      *CertificateSubject `json:"subject,omitempty"`
}

// ProfileListResponse defines model for ProfileListResponse.
type ProfileListResponse struct {
	Profiles []ProfileSummary `json:"profiles"`
}

// ProfileResponse defines model for ProfileResponse.
type ProfileResponse struct {
	// AllowedKeyTypes Allowed key algorithms and sizes
	AllowedKeyTypes *[]string `json:"allowed_key_types,omitempty"`
	Category        *string   `json:"category,omitempty"`
	Description     *string   `json:"description,omitempty"`

	// ExtendedKeyUsage Allowed extended key usages
	ExtendedKeyUsage *[]string `json:"extended_key_usage,omitempty"`
	ID               string    `json:"id"`

	// KeyUsage Allowed key usages
	KeyUsage *[]string `json:"key_usage,omitempty"`

	// MaxValidityDays Maximum validity period in days
	MaxValidityDays     *int                 `json:"max_validity_days,omitempty"`
	Name                string               `json:"name"`
	SANRequirements     *SANRequirements     `json:"san_requirements,omitempty"`
	SubjectRequirements *SubjectRequirements `json:"subject_requirements,omitempty"`
}

// ProfileSummary defines model for ProfileSummary.
type ProfileSummary struct {
	Category *ProfileSummaryCategory `json:"category,omitempty"`

	// Description Profile description
	Description *string `json:"description,omitempty"`

	// ID Profile identifier
	ID string `json:"id"`

	// Name Human-readable profile name
	Name string `json:"name"`
}

// ProfileSummaryCategory defines model for ProfileSummary.Category.
type ProfileSummaryCategory string

// RevocationReason RFC 5280 CRLReason enumeration
type RevocationReason string

// RevocationRequest defines model for RevocationRequest.
type RevocationRequest struct {
	// Comment Optional comment explaining the reason for revocation
	Comment *string `json:"comment,omitempty"`

	// Reason RFC 5280 CRLReason enumeration
	Reason RevocationReason `json:"reason"`
}

// RevocationResponse defines model for RevocationResponse.
type RevocationResponse struct {
	// Message Human-readable confirmation message
	Message *string `json:"message,omitempty"`

	// Reason RFC 5280 CRLReason enumeration
	Reason RevocationReason `json:"reason"`

	// RevokedAt Time when the certificate was revoked
	RevokedAt time.Time `json:"revoked_at"`

	// SerialNumber Serial number of the revoked certificate
	SerialNumber string `json:"serial_number"`

	// Status Certificate status (always 'revoked')
	Status RevocationResponseStatus `json:"status"`
}

// RevocationResponseStatus Certificate status (always 'revoked')
type RevocationResponseStatus string

// SANOverride Optional Subject Alternative Name overrides
type SANOverride struct {
	// DNSNames DNS names to include in the certificate
	DNSNames *[]string `json:"dns_names,omitempty"`

	// EmailAddresses Email addresses to include in the certificate
	EmailAddresses *[]string `json:"email_addresses,omitempty"`

	// IPAddresses IP addresses to include in the certificate
	IPAddresses *[]string `json:"ip_addresses,omitempty"`

	// Uris URIs to include in the certificate
	Uris *[]string `json:"uris,omitempty"`
}

// SANRequirements defines model for SANRequirements.
type SANRequirements struct {
	DNSNamesAllowed       *bool `json:"dns_names_allowed,omitempty"`
	DNSNamesRequired      *bool `json:"dns_names_required,omitempty"`
	EmailAddressesAllowed *bool `json:"email_addresses_allowed,omitempty"`
	IPAddressesAllowed    *bool `json:"ip_addresses_allowed,omitempty"`
	UrisAllowed           *bool `json:"uris_allowed,omitempty"`
}

// SubjectOverride Optional subject DN field overrides
type SubjectOverride struct {
	// Country Country (C) values
	Country *[]string `json:"country,omitempty"`

	// Locality Locality (L) values
	Locality *[]string `json:"locality,omitempty"`

	// Organization Organization (O) values
	Organization *[]string `json:"organization,omitempty"`

	// OrganizationalUnit Organizational Unit (OU) values
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`

	// State State or Province (ST) values
	State *[]string `json:"state,omitempty"`
}

// SubjectRequirements defines model for SubjectRequirements.
type SubjectRequirements struct {
	AllowedCountries    *[]string `json:"allowed_countries,omitempty"`
	RequireCommonName   *bool     `json:"require_common_name,omitempty"`
	RequireCountry      *bool     `json:"require_country,omitempty"`
	RequireOrganization *bool     `json:"require_organization,omitempty"`
}

// ListCertificatesParams defines parameters for ListCertificates.
type ListCertificatesParams struct {
	// Profile Filter by certificate profile
	Profile *string `form:"profile,omitempty" json:"profile,omitempty"`

	// Status Filter by certificate status
	Status *CertificateStatus `form:"status,omitempty" json:"status,omitempty"`

	// SubjectCN Filter by subject common name (partial match)
	SubjectCN *string `form:"subject_cn,omitempty" json:"subject_cn,omitempty"`

	// Page Page number for pagination
	Page *int `form:"page,omitempty" json:"page,omitempty"`

	// PageSize Number of results per page
	PageSize *int `form:"page_size,omitempty" json:"page_size,omitempty"`
}

// RevokeCertificateJSONRequestBody defines body for RevokeCertificate for application/json ContentType.
type RevokeCertificateJSONRequestBody = RevocationRequest

// SubmitEnrollmentJSONRequestBody defines body for SubmitEnrollment for application/json ContentType.
type SubmitEnrollmentJSONRequestBody = EnrollmentRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// List certificates
	// (GET /certificates)
	ListCertificates(c *fiber.Ctx, params ListCertificatesParams) error
	// Get certificate by serial number
	// (GET /certificates/{serialNumber})
	GetCertificate(c *fiber.Ctx, serialNumber string) error
	// Get certificate chain
	// (GET /certificates/{serialNumber}/chain)
	GetCertificateChain(c *fiber.Ctx, serialNumber string) error
	// Revoke a certificate
	// (POST /certificates/{serialNumber}/revoke)
	RevokeCertificate(c *fiber.Ctx, serialNumber string) error
	// Submit certificate enrollment request
	// (POST /enroll)
	SubmitEnrollment(c *fiber.Ctx) error
	// Get enrollment request status
	// (GET /enroll/{requestId})
	GetEnrollmentStatus(c *fiber.Ctx, requestID openapi_types.UUID) error
	// List available certificate profiles
	// (GET /profiles)
	ListProfiles(c *fiber.Ctx) error
	// Get certificate profile details
	// (GET /profiles/{profileId})
	GetProfile(c *fiber.Ctx, profileID string) error
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler ServerInterface
}

type MiddlewareFunc fiber.Handler

// ListCertificates operation middleware
func (siw *ServerInterfaceWrapper) ListCertificates(c *fiber.Ctx) error {

	var err error

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params ListCertificatesParams

	var query url.Values
	query, err = url.ParseQuery(string(c.Request().URI().QueryString()))
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for query string: %w", err).Error())
	}

	// ------------- Optional query parameter "profile" -------------

	err = runtime.BindQueryParameter("form", true, false, "profile", query, &params.Profile)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profile: %w", err).Error())
	}

	// ------------- Optional query parameter "status" -------------

	err = runtime.BindQueryParameter("form", true, false, "status", query, &params.Status)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter status: %w", err).Error())
	}

	// ------------- Optional query parameter "subject_cn" -------------

	err = runtime.BindQueryParameter("form", true, false, "subject_cn", query, &params.SubjectCN)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter subject_cn: %w", err).Error())
	}

	// ------------- Optional query parameter "page" -------------

	err = runtime.BindQueryParameter("form", true, false, "page", query, &params.Page)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page: %w", err).Error())
	}

	// ------------- Optional query parameter "page_size" -------------

	err = runtime.BindQueryParameter("form", true, false, "page_size", query, &params.PageSize)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page_size: %w", err).Error())
	}

	return siw.Handler.ListCertificates(c, params)
}

// GetCertificate operation middleware
func (siw *ServerInterfaceWrapper) GetCertificate(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificate(c, serialNumber)
}

// GetCertificateChain operation middleware
func (siw *ServerInterfaceWrapper) GetCertificateChain(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificateChain(c, serialNumber)
}

// RevokeCertificate operation middleware
func (siw *ServerInterfaceWrapper) RevokeCertificate(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.RevokeCertificate(c, serialNumber)
}

// SubmitEnrollment operation middleware
func (siw *ServerInterfaceWrapper) SubmitEnrollment(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.SubmitEnrollment(c)
}

// GetEnrollmentStatus operation middleware
func (siw *ServerInterfaceWrapper) GetEnrollmentStatus(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "requestId" -------------
	var requestID openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "requestId", c.Params("requestId"), &requestID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter requestId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetEnrollmentStatus(c, requestID)
}

// ListProfiles operation middleware
func (siw *ServerInterfaceWrapper) ListProfiles(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.ListProfiles(c)
}

// GetProfile operation middleware
func (siw *ServerInterfaceWrapper) GetProfile(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "profileId" -------------
	var profileID string

	err = runtime.BindStyledParameterWithOptions("simple", "profileId", c.Params("profileId"), &profileID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profileId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetProfile(c, profileID)
}

// FiberServerOptions provides options for the Fiber server.
type FiberServerOptions struct {
	BaseURL     string
	Middlewares []MiddlewareFunc
}

// RegisterHandlers creates http.Handler with routing matching OpenAPI spec.
func RegisterHandlers(router fiber.Router, si ServerInterface) {
	RegisterHandlersWithOptions(router, si, FiberServerOptions{})
}

// RegisterHandlersWithOptions creates http.Handler with additional options
func RegisterHandlersWithOptions(router fiber.Router, si ServerInterface, options FiberServerOptions) {
	wrapper := ServerInterfaceWrapper{
		Handler: si,
	}

	for _, m := range options.Middlewares {
		router.Use(fiber.Handler(m))
	}

	router.Get(options.BaseURL+"/certificates", wrapper.ListCertificates)

	router.Get(options.BaseURL+"/certificates/:serialNumber", wrapper.GetCertificate)

	router.Get(options.BaseURL+"/certificates/:serialNumber/chain", wrapper.GetCertificateChain)

	router.Post(options.BaseURL+"/certificates/:serialNumber/revoke", wrapper.RevokeCertificate)

	router.Post(options.BaseURL+"/enroll", wrapper.SubmitEnrollment)

	router.Get(options.BaseURL+"/enroll/:requestId", wrapper.GetEnrollmentStatus)

	router.Get(options.BaseURL+"/profiles", wrapper.ListProfiles)

	router.Get(options.BaseURL+"/profiles/:profileId", wrapper.GetProfile)

}

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"H4sIAAAAAAAC/+Q763LbNtavguH3zdSZkSXbibOtfq2iKKl3HMeVnNluk4wGIo8kNCTAAKBkNeN338GF",
	"FEiC1KVxms62fyzp4ODg3G/5EoQsSRkFKkXQ/xKIcAkJ1n8OgUsyJyGWMFxiQscgUkYFqN9SzlL1M2jI",
	"cAupP0cgQk5SSRgN+oE+jFwYNOcsQTHgOZIMccZk0AmIhESf/n8O86Af/F9vS1nPktXTuBzCgodOIDcp",
	"BP0Ac443wcNDJ+DwOSMcoqD/vkzaxwKYzX6HUKrTDrJrIuT+j9yP3u2hSZYkmG/qFHeCFC/Aw7eMc6AS",
	"qV8RzZIZ8KA4S6iEBfD89FSQPzwobvQpxOaIg8hiKVAKXCP0YpJM4riO5U59bSlQuBIswyWhi5JMPQjb",
	"RJFfZh/vvmKHlPaS0DSFRH1lEQnJCV0oRHNCF8BTTqiciiW+uHzuBSNCZMAPkm5BK2VyiufSHJ8znmAZ",
	"9IMISziVJHE4v71OHZnBnHHY/0zK2ZzE4CWfw4qFWIlvygELJcWqUMf6ezRnHG2h0QmZ64+fIHriu9RB",
	"rOmq6wpJwOhbE879XieAExxPrdr73igkltlBBmgOqKNWWEeIt6LTZTILojo1Xdyh1JPiMRUfsAVBBW6g",
	"WaIux6EkK8U9y131032qSfvoYannOXUTYknC6JTixK9YIcuo5JuS/6sBVd1bRIXGKA47Bgkm8RRHEQch",
	"Dj1M0mNPxizEMZEHvpHxBabkD2zkduxJHE8zSuRhCJRewCFHHnboog1UNeX4Dhzbt3AL05B6MO9r+A4S",
	"r81XE5ijohgR0xA7v8wYiwHTPxu5vp5frD5ii9vHlBHlLI4ToPIWaEToojnGg5AkwRKiqSIshtzeym5z",
	"lEMhpWQ6yOE05WylM4791DABIbx52SCKiDFW65IRoQal+t0bND9nIOSURHVk7yj5nAGCggPIQiMSAVU8",
	"1OpVkJxlJPLGy4YAsmVtPX6khtmeYFGRpvOA4qZ2OY7NCY92C94e5SZkQVVuOc7ZQNHt6A0yDOiiN5mQ",
	"aAYLQtGayCX6EJyq/16MXl/doOFofHf16mo4uBuh8eiXd6PJnf71Q4AwjRDQqHRodPOy5Uj3A9UBFSs1",
	"C/p73UPfXF0N/3M3HA7efRoOfhmsf345wm9eLF4Pzt+NBuv1+Ldfl8vZry/Eb5NLMbu4Wc5eL1fh01/W",
	"H2i32/1Ad5NFd3jMZsZaIEevVPGVCWMeym1gGkLpyTIWpwL4yi08HJXDdMpWwDmJYJfLmAxu3uagjqfd",
	"+7iBd1GscEwiIjfTCG+EL73V6gMRygFV6UNYpBRKHUEnCd6gGSDJMxpqXzHb5Ex64rLh6fPLTpDge5Io",
	"s/nxQn0i1Hw63131CMW8XEK7rGaP0mYXr65UAIgqNfL36oJ0tIqO80ClJHsHZ02Qf0z+qjv3rrcssC6N",
	"8hgi7PeNlZcrwQOEUfX2ncCEQl0v5FcGnWZRaHNNiFRBF8v987gsjfBhZ44NO5wz/hIkJnFdsnMCsUfp",
	"X6mvkVxiiUKcCZUpLAGBwnRQMqDvRu53vlf5SW5Wx0g/Zv82k8sBXyWln9VAe8iiw/Kfn7ME01MOOMKz",
	"2PIM5dC7ZGpI8Umxblf7pMbN8a6UOPgeGKpU3I/nVRbHbncLadgySnQC92GcKZvSLUyv1frbTeXLJj8P",
	"Ti8unyMHFrG51kfXLbmBeXDef3HRHz7tv3zWH132Xz3vd7vdpvqrKNmaeVXESJUiWds8psDb4wYhMZeH",
	"3VEr+lp6JBo071WeLOH+FKjS8KgU0oOz88HFi6fDZy8vR89f/SPw+7xH6hHVayOHia7IfFZyaxKJ9la1",
	"zTb29x8Wa2OLuvKiAn8Lhc3U4Thma4imn2AzVac9KcPAgKBPsEE4XjBO5DIROokX5A/dPt6/P6IYvWCm",
	"oVEDLt3r+R3uJdDIUps1FISW2hxWk61hDyPUhPYa2B43H3lhgu+nO/LoNybvbcqivWOExu6hqhisHiX5",
	"wGlH1TB2wZ3K4SA05kwZVUWldY6hCW/R6cbOmKtieb4lY53oJiomdwLlg6bC1LZBJ4hYmClCnK9CHHQC",
	"Jpclw29U1LKULH3teUiuYP6jpVy/7uZxsjsTyCtMDbwrEWhn+LgYH4yb8ulXQ3R58eMZGo6vbW6tOA88",
	"b8PkcsioSCFUL1M3KmNSKsJZQgRotpc/4/mcxMSMOMIlpgt9TGQpcAGR/hCqXEcDsPlUqUF+pevZlyw2",
	"CXbCVjCdc5ZMQ67nXZysSAwLmK6JXEYcr9VRXCLDpwAuS5qaKyxRSlVn1tvUNqwsBIL7NMZEN1pUnsF9",
	"w6BAO4hroAu5DPqXZ2feqiSXTpsB1qRZz/T117s0oSmi7JuqhozOiW3UNWesx7+qmMTYmsczGlsvgVZT",
	"O7TGAm1nOF8lKZqUEiGbTto7Kmnl3oV8fRiFTnC8xhuBfrCof3jiWF7+pJ3VfWMz3WFnp01J3PZSs/Lb",
	"OIAGsQROsSQrQDc4AZS3oYTp1LiFmDu6KqN9eTPRnk4gyRChqhTQRUdL3v4+/7MbMpX3rdfrrvvNx86f",
	"G49VyjsFgAqAQ8jEUULoP48mrTp8K9N1dXscUec/XXTPn//YPe+eB53g/Kyr/j8/jLKMEw9F78ZXB1Gy",
	"lDIV/V7vSAY9+DV4XElpGjRxavNn//hnC7Y1MB9cRXvakbrybIdU/G2D8D690txtNmCb/KGXN0i3dVoM",
	"1xlUV5yY+QGdDJ+opDY7MGV2p8NlxNf2F3RyfRTm6gS5wgPnV3Ty9k/f4Eyamy/CMXpHiUQnb98ddWEx",
	"ma7EJvU1YhzdcrYiNAR0Mrk74oIWZWq3pbwCNUpCDt0QsJY19S9LONawBSyUsRmoKv/dpqOzgDDjRG4m",
	"Kicx75gB5sAHmUra8k+v8pTiX/++Cyq1hPoO4UwuVf5vV3Yk+wQq/9OpjqZCo9kmC8oDBg+KAkLnzBgc",
	"ldj0SwxDgsHtFZpkacq4rBUwpVxC0apK/A1yRgXqtMpH3Twpn0vofrQQhNFOMbjqIA5Kliscd0yjwGQo",
	"4RLCT4QuujktAiVZLEkal3OwvKdhg4DKjO+uJ8iMvzr67zAmQGVHd0yRLdzMXZPem6s3IzMxjEkINkvN",
	"GZHicAnoonsWKA8ZW/6pCKIyAKx/7jK+6Nmzond9NRzdTEan6owSPJG6bTUcVFgUdIIVcGF4eq4iojb0",
	"FChOSdAPnnbPuk/1dp1cau3oVdcYFyB9wwrNSkAYxUTodqQZD5TXOPUwleXeeU5UXqVYHWgSTFl0FSnf",
	"SIQcltf/UsxxAhK4CPrv6915hQrNNj4RKQ+hgD5nwDd5EdkPtr+aBN27w7HfRUX+6btnu+lRXHPgpkkb",
	"GXmIM75FJ5joJMVcqmxeL14+aaJru3hyEAtut+ul2uBSvCA0LwC9jDZV0/aKCOY4i6WehrZPRg/aT226",
	"22yJegm4OHMmteeqYm2l56Pyvqao1LZwcXaWuzJbRuM0ja1T7P1ua8KD5V5q1mqnWckcrImVTFN797zf",
	"ZECqC7R4oWwnKBnWR3WuZOS9L6a8Mrx+2MfmbcMkLBnFbIOIFOUOe93SX4Nr6LvsfP/WvVYG5cUchXee",
	"FbgFpeQZtJnANxK7I/JOCeP9aQrJab6xscVbFP4zQrHW+irlrWHUxj+IVAh4dvbsq72pPKzcQQVlEs1Z",
	"RqOKBr8GWVWnksSPVuiens3tVmtV0c39cz29H+Z+33GyABzHSLkMnkBE1JnhQKAsVfXiySyT+sEF9BPT",
	"Z2FMmmSgzTj0KuD/tIWU/1nJNzITI/K/l7GEVlWOtBDTRtN1EBNeG1G/l03A7+/RXbV1SeIYzQAlmH+C",
	"CG0bmTovxlEEkbIUZRUU7iUajq99lmEo+HtEDl2DvGDR5qvpTL21/1BukSq6Hh7RJj1N9p3BxkhZZGEI",
	"QijHujGmdPbtTOmK6rFkXhd+L6asqPjpr6ECxxxwtCmmCWW34rPzdq9ilgKbPcdEb4ZVPIctjYty/WQ4",
	"GT+xQZbC2oU1DiUHTDIhiyYsNjNnNJyMK4s3urrXKepGO5YIhDITX63o8zWG5m0dHTyOUdeXofcy6vNH",
	"IaBZe5x+Ag5DSKV13S4z7WrgQye4OLt4BPqqW/97kmk3Grer/d+D/7m4+IaWPxkbIzFduzkmcc3mrYW6",
	"4qxv+jpOwLEL1wX0vljQq+hhv1zb9t/YHOFCUvWbvRVkdW93VzIw2rG67EkBite0xv8da7aPmic3Li+3",
	"W4dl+1+X33qE0ZbmetbOiw5bo066C267NTGu91e27V68wiTW2wEqQG2p8Tcxb/OLH1HwvhW/lq5RwQtP",
	"x2j7ON/bHQ4X7yrzt/fF/rWX1ZutZYjcfw+F8IxlsqmnlEdpnxO4Lfq5rbbv3V/yGHzxkO+mEK4uSnpk",
	"vN3r0vvgf6FV55TsW7GmZcobVM2ZYGnRurOr9x8V9838xVsBDvSMaIYFICtqM1vp4ZT0Vue9EAcKg723",
	"rYB0fFChhmKrOo77qbewPR04HHvRlNLrdkQ593xoCv49fHz4bwAAAP//LLv5cb5DAAA=",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
