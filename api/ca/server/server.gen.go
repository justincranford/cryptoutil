// Package server provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package server

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"
	"time"

	"github.com/getkin/kin-openapi/openapi3"
	"github.com/gofiber/fiber/v2"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "bearerAuth.Scopes"
)

// Defines values for CertificateStatus.
const (
	Active  CertificateStatus = "active"
	Expired CertificateStatus = "expired"
	Revoked CertificateStatus = "revoked"
)

// Defines values for EnrollmentPendingResponseStatus.
const (
	EnrollmentPendingResponseStatusPending EnrollmentPendingResponseStatus = "pending"
)

// Defines values for EnrollmentResponseStatus.
const (
	Issued EnrollmentResponseStatus = "issued"
)

// Defines values for EnrollmentStatusResponseStatus.
const (
	EnrollmentStatusResponseStatusApproved EnrollmentStatusResponseStatus = "approved"
	EnrollmentStatusResponseStatusIssued   EnrollmentStatusResponseStatus = "issued"
	EnrollmentStatusResponseStatusPending  EnrollmentStatusResponseStatus = "pending"
	EnrollmentStatusResponseStatusRejected EnrollmentStatusResponseStatus = "rejected"
)

// Defines values for ProfileSummaryCategory.
const (
	CA              ProfileSummaryCategory = "ca"
	CodeSigning     ProfileSummaryCategory = "code_signing"
	DocumentSigning ProfileSummaryCategory = "document_signing"
	Email           ProfileSummaryCategory = "email"
	Other           ProfileSummaryCategory = "other"
	TLS             ProfileSummaryCategory = "tls"
)

// CertificateChainResponse defines model for CertificateChainResponse.
type CertificateChainResponse struct {
	// Certificates Chain certificates from leaf to root
	Certificates []ChainCertificate `json:"certificates"`
}

// CertificateListResponse defines model for CertificateListResponse.
type CertificateListResponse struct {
	Certificates []CertificateSummary `json:"certificates"`

	// Page Current page number
	Page int `json:"page"`

	// PageSize Number of results per page
	PageSize int `json:"page_size"`

	// Total Total number of matching certificates
	Total int `json:"total"`
}

// CertificateResponse defines model for CertificateResponse.
type CertificateResponse struct {
	CertificatePEM    string              `json:"certificate_pem"`
	FingerprintSha256 *string             `json:"fingerprint_sha256,omitempty"`
	Issuer            *CertificateSubject `json:"issuer,omitempty"`
	NotAfter          *time.Time          `json:"not_after,omitempty"`
	NotBefore         *time.Time          `json:"not_before,omitempty"`
	Profile           *string             `json:"profile,omitempty"`

	// RevocationReason Reason for revocation (if revoked)
	RevocationReason *string `json:"revocation_reason,omitempty"`

	// RevocationTime Time of revocation (if revoked)
	RevocationTime *time.Time `json:"revocation_time,omitempty"`
	SerialNumber   string     `json:"serial_number"`

	// Status Certificate status
	Status  CertificateStatus   `json:"status"`
	Subject *CertificateSubject `json:"subject,omitempty"`
}

// CertificateStatus Certificate status
type CertificateStatus string

// CertificateSubject defines model for CertificateSubject.
type CertificateSubject struct {
	CommonName         *string   `json:"common_name,omitempty"`
	Country            *[]string `json:"country,omitempty"`
	DNSNames           *[]string `json:"dns_names,omitempty"`
	EmailAddresses     *[]string `json:"email_addresses,omitempty"`
	IPAddresses        *[]string `json:"ip_addresses,omitempty"`
	Locality           *[]string `json:"locality,omitempty"`
	Organization       *[]string `json:"organization,omitempty"`
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`
	State              *[]string `json:"state,omitempty"`
}

// CertificateSummary defines model for CertificateSummary.
type CertificateSummary struct {
	NotAfter     *time.Time `json:"not_after,omitempty"`
	NotBefore    *time.Time `json:"not_before,omitempty"`
	Profile      *string    `json:"profile,omitempty"`
	SerialNumber string     `json:"serial_number"`

	// Status Certificate status
	Status    CertificateStatus `json:"status"`
	SubjectCN string            `json:"subject_cn"`
}

// ChainCertificate defines model for ChainCertificate.
type ChainCertificate struct {
	CertificatePEM string              `json:"certificate_pem"`
	IsCA           *bool               `json:"is_ca,omitempty"`
	Issuer         *CertificateSubject `json:"issuer,omitempty"`
	Subject        CertificateSubject  `json:"subject"`
}

// EnrollmentPendingResponse defines model for EnrollmentPendingResponse.
type EnrollmentPendingResponse struct {
	// EstimatedCompletion Estimated time for approval
	EstimatedCompletion *time.Time `json:"estimated_completion,omitempty"`

	// Message Additional status information
	Message *string `json:"message,omitempty"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentPendingResponseStatus `json:"status"`
}

// EnrollmentPendingResponseStatus Enrollment status
type EnrollmentPendingResponseStatus string

// EnrollmentRequest defines model for EnrollmentRequest.
type EnrollmentRequest struct {
	// CSR Certificate Signing Request in PEM format. Must begin with "-----BEGIN CERTIFICATE REQUEST-----" and end with "-----END CERTIFICATE REQUEST-----".
	CSR string `json:"csr"`

	// Profile Certificate profile identifier to use for issuance
	Profile string `json:"profile"`

	// SANOverride Optional Subject Alternative Name overrides
	SANOverride *SANOverride `json:"san_override,omitempty"`

	// SubjectOverride Optional subject DN field overrides
	SubjectOverride *SubjectOverride `json:"subject_override,omitempty"`

	// ValidityDays Requested validity period in days (may be truncated by profile)
	ValidityDays *int `json:"validity_days,omitempty"`
}

// EnrollmentResponse defines model for EnrollmentResponse.
type EnrollmentResponse struct {
	Certificate IssuedCertificate `json:"certificate"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentResponseStatus `json:"status"`
}

// EnrollmentResponseStatus Enrollment status
type EnrollmentResponseStatus string

// EnrollmentStatusResponse defines model for EnrollmentStatusResponse.
type EnrollmentStatusResponse struct {
	Certificate *IssuedCertificate `json:"certificate,omitempty"`

	// RejectionReason Reason for rejection (if status is rejected)
	RejectionReason *string                        `json:"rejection_reason,omitempty"`
	RequestID       openapi_types.UUID             `json:"request_id"`
	Status          EnrollmentStatusResponseStatus `json:"status"`
	SubmittedAt     *time.Time                     `json:"submitted_at,omitempty"`
	UpdatedAt       *time.Time                     `json:"updated_at,omitempty"`
}

// EnrollmentStatusResponseStatus defines model for EnrollmentStatusResponse.Status.
type EnrollmentStatusResponseStatus string

// ErrorDetail defines model for ErrorDetail.
type ErrorDetail struct {
	// Field Field that caused the error
	Field *string `json:"field,omitempty"`

	// Message Error description
	Message *string `json:"message,omitempty"`
}

// ErrorResponse defines model for ErrorResponse.
type ErrorResponse struct {
	Details *[]ErrorDetail `json:"details,omitempty"`

	// Error Error code
	Error string `json:"error"`

	// Message Human-readable error message
	Message *string `json:"message,omitempty"`
}

// IssuedCertificate defines model for IssuedCertificate.
type IssuedCertificate struct {
	// CertificatePEM Certificate in PEM format
	CertificatePEM string `json:"certificate_pem"`

	// ChainPEM Full certificate chain in PEM format (excluding root)
	ChainPEM *string `json:"chain_pem,omitempty"`

	// FingerprintSha256 SHA-256 fingerprint of the certificate
	FingerprintSha256 *string `json:"fingerprint_sha256,omitempty"`

	// NotAfter Certificate validity end time
	NotAfter time.Time `json:"not_after"`

	// NotBefore Certificate validity start time
	NotBefore time.Time `json:"not_before"`

	// SerialNumber Certificate serial number (hex-encoded)
	SerialNumber string              `json:"serial_number"`
	Subject      *CertificateSubject `json:"subject,omitempty"`
}

// ProfileListResponse defines model for ProfileListResponse.
type ProfileListResponse struct {
	Profiles []ProfileSummary `json:"profiles"`
}

// ProfileResponse defines model for ProfileResponse.
type ProfileResponse struct {
	// AllowedKeyTypes Allowed key algorithms and sizes
	AllowedKeyTypes *[]string `json:"allowed_key_types,omitempty"`
	Category        *string   `json:"category,omitempty"`
	Description     *string   `json:"description,omitempty"`

	// ExtendedKeyUsage Allowed extended key usages
	ExtendedKeyUsage *[]string `json:"extended_key_usage,omitempty"`
	ID               string    `json:"id"`

	// KeyUsage Allowed key usages
	KeyUsage *[]string `json:"key_usage,omitempty"`

	// MaxValidityDays Maximum validity period in days
	MaxValidityDays     *int                 `json:"max_validity_days,omitempty"`
	Name                string               `json:"name"`
	SANRequirements     *SANRequirements     `json:"san_requirements,omitempty"`
	SubjectRequirements *SubjectRequirements `json:"subject_requirements,omitempty"`
}

// ProfileSummary defines model for ProfileSummary.
type ProfileSummary struct {
	Category *ProfileSummaryCategory `json:"category,omitempty"`

	// Description Profile description
	Description *string `json:"description,omitempty"`

	// ID Profile identifier
	ID string `json:"id"`

	// Name Human-readable profile name
	Name string `json:"name"`
}

// ProfileSummaryCategory defines model for ProfileSummary.Category.
type ProfileSummaryCategory string

// SANOverride Optional Subject Alternative Name overrides
type SANOverride struct {
	// DNSNames DNS names to include in the certificate
	DNSNames *[]string `json:"dns_names,omitempty"`

	// EmailAddresses Email addresses to include in the certificate
	EmailAddresses *[]string `json:"email_addresses,omitempty"`

	// IPAddresses IP addresses to include in the certificate
	IPAddresses *[]string `json:"ip_addresses,omitempty"`

	// Uris URIs to include in the certificate
	Uris *[]string `json:"uris,omitempty"`
}

// SANRequirements defines model for SANRequirements.
type SANRequirements struct {
	DNSNamesAllowed       *bool `json:"dns_names_allowed,omitempty"`
	DNSNamesRequired      *bool `json:"dns_names_required,omitempty"`
	EmailAddressesAllowed *bool `json:"email_addresses_allowed,omitempty"`
	IPAddressesAllowed    *bool `json:"ip_addresses_allowed,omitempty"`
	UrisAllowed           *bool `json:"uris_allowed,omitempty"`
}

// SubjectOverride Optional subject DN field overrides
type SubjectOverride struct {
	// Country Country (C) values
	Country *[]string `json:"country,omitempty"`

	// Locality Locality (L) values
	Locality *[]string `json:"locality,omitempty"`

	// Organization Organization (O) values
	Organization *[]string `json:"organization,omitempty"`

	// OrganizationalUnit Organizational Unit (OU) values
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`

	// State State or Province (ST) values
	State *[]string `json:"state,omitempty"`
}

// SubjectRequirements defines model for SubjectRequirements.
type SubjectRequirements struct {
	AllowedCountries    *[]string `json:"allowed_countries,omitempty"`
	RequireCommonName   *bool     `json:"require_common_name,omitempty"`
	RequireCountry      *bool     `json:"require_country,omitempty"`
	RequireOrganization *bool     `json:"require_organization,omitempty"`
}

// ListCertificatesParams defines parameters for ListCertificates.
type ListCertificatesParams struct {
	// Profile Filter by certificate profile
	Profile *string `form:"profile,omitempty" json:"profile,omitempty"`

	// Status Filter by certificate status
	Status *CertificateStatus `form:"status,omitempty" json:"status,omitempty"`

	// SubjectCN Filter by subject common name (partial match)
	SubjectCN *string `form:"subject_cn,omitempty" json:"subject_cn,omitempty"`

	// Page Page number for pagination
	Page *int `form:"page,omitempty" json:"page,omitempty"`

	// PageSize Number of results per page
	PageSize *int `form:"page_size,omitempty" json:"page_size,omitempty"`
}

// SubmitEnrollmentJSONRequestBody defines body for SubmitEnrollment for application/json ContentType.
type SubmitEnrollmentJSONRequestBody = EnrollmentRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// List certificates
	// (GET /certificates)
	ListCertificates(c *fiber.Ctx, params ListCertificatesParams) error
	// Get certificate by serial number
	// (GET /certificates/{serialNumber})
	GetCertificate(c *fiber.Ctx, serialNumber string) error
	// Get certificate chain
	// (GET /certificates/{serialNumber}/chain)
	GetCertificateChain(c *fiber.Ctx, serialNumber string) error
	// Submit certificate enrollment request
	// (POST /enroll)
	SubmitEnrollment(c *fiber.Ctx) error
	// Get enrollment request status
	// (GET /enroll/{requestId})
	GetEnrollmentStatus(c *fiber.Ctx, requestID openapi_types.UUID) error
	// List available certificate profiles
	// (GET /profiles)
	ListProfiles(c *fiber.Ctx) error
	// Get certificate profile details
	// (GET /profiles/{profileId})
	GetProfile(c *fiber.Ctx, profileID string) error
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler ServerInterface
}

type MiddlewareFunc fiber.Handler

// ListCertificates operation middleware
func (siw *ServerInterfaceWrapper) ListCertificates(c *fiber.Ctx) error {

	var err error

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params ListCertificatesParams

	var query url.Values
	query, err = url.ParseQuery(string(c.Request().URI().QueryString()))
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for query string: %w", err).Error())
	}

	// ------------- Optional query parameter "profile" -------------

	err = runtime.BindQueryParameter("form", true, false, "profile", query, &params.Profile)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profile: %w", err).Error())
	}

	// ------------- Optional query parameter "status" -------------

	err = runtime.BindQueryParameter("form", true, false, "status", query, &params.Status)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter status: %w", err).Error())
	}

	// ------------- Optional query parameter "subject_cn" -------------

	err = runtime.BindQueryParameter("form", true, false, "subject_cn", query, &params.SubjectCN)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter subject_cn: %w", err).Error())
	}

	// ------------- Optional query parameter "page" -------------

	err = runtime.BindQueryParameter("form", true, false, "page", query, &params.Page)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page: %w", err).Error())
	}

	// ------------- Optional query parameter "page_size" -------------

	err = runtime.BindQueryParameter("form", true, false, "page_size", query, &params.PageSize)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page_size: %w", err).Error())
	}

	return siw.Handler.ListCertificates(c, params)
}

// GetCertificate operation middleware
func (siw *ServerInterfaceWrapper) GetCertificate(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificate(c, serialNumber)
}

// GetCertificateChain operation middleware
func (siw *ServerInterfaceWrapper) GetCertificateChain(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificateChain(c, serialNumber)
}

// SubmitEnrollment operation middleware
func (siw *ServerInterfaceWrapper) SubmitEnrollment(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.SubmitEnrollment(c)
}

// GetEnrollmentStatus operation middleware
func (siw *ServerInterfaceWrapper) GetEnrollmentStatus(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "requestId" -------------
	var requestID openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "requestId", c.Params("requestId"), &requestID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter requestId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetEnrollmentStatus(c, requestID)
}

// ListProfiles operation middleware
func (siw *ServerInterfaceWrapper) ListProfiles(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.ListProfiles(c)
}

// GetProfile operation middleware
func (siw *ServerInterfaceWrapper) GetProfile(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "profileId" -------------
	var profileID string

	err = runtime.BindStyledParameterWithOptions("simple", "profileId", c.Params("profileId"), &profileID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profileId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetProfile(c, profileID)
}

// FiberServerOptions provides options for the Fiber server.
type FiberServerOptions struct {
	BaseURL     string
	Middlewares []MiddlewareFunc
}

// RegisterHandlers creates http.Handler with routing matching OpenAPI spec.
func RegisterHandlers(router fiber.Router, si ServerInterface) {
	RegisterHandlersWithOptions(router, si, FiberServerOptions{})
}

// RegisterHandlersWithOptions creates http.Handler with additional options
func RegisterHandlersWithOptions(router fiber.Router, si ServerInterface, options FiberServerOptions) {
	wrapper := ServerInterfaceWrapper{
		Handler: si,
	}

	for _, m := range options.Middlewares {
		router.Use(fiber.Handler(m))
	}

	router.Get(options.BaseURL+"/certificates", wrapper.ListCertificates)

	router.Get(options.BaseURL+"/certificates/:serialNumber", wrapper.GetCertificate)

	router.Get(options.BaseURL+"/certificates/:serialNumber/chain", wrapper.GetCertificateChain)

	router.Post(options.BaseURL+"/enroll", wrapper.SubmitEnrollment)

	router.Get(options.BaseURL+"/enroll/:requestId", wrapper.GetEnrollmentStatus)

	router.Get(options.BaseURL+"/profiles", wrapper.ListProfiles)

	router.Get(options.BaseURL+"/profiles/:profileId", wrapper.GetProfile)

}

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"H4sIAAAAAAAC/+Q6W3PbNtZ/BYPve3BmZMlSLtvV0yqKkmondlzLnu028Wgg8khCQwIMANpWM/rvOwB4",
	"ASmQurRJu7PJi0UcHByc+wVfccDjhDNgSuLhVyyDNcTE/DkGoeiSBkTBeE0ouwGZcCZBryWCJ3oZDGRQ",
	"QprfIchA0ERRzvAQm83IhUFLwWMUAVkixZHgXOEOpgpis/v/BSzxEP9fr6Ssl5HVM7gcwvC2g9UmATzE",
	"RAiywdttBwv4klIBIR5+rJJ2XwDzxa8QKL3bQfaeSnX4JQ+jt9w0S+OYiM0uxR2ckBV4+JYKAUwhvYpY",
	"Gi9A4GIvZQpWIPLdc0l/86C4MrsQXyIBMo2URAkIg9CLSXFFol0st/pzRoHGFRMVrClbVWTqQdgmivyw",
	"7PLuLfZI6SAJzROI9acMkVSCspVGtKRsBSIRlKm5XJPBy1deMCplCuIo6Ra0Mq7mZKns9iUXMVF4iEOi",
	"4FzR2OF8eZzesoAlF3D4nkTwJY3AS76ABx4QLb65ACK1FOtCvTHf0ZILVEKjM7o0Pz9D+Mx3qIPY0LWr",
	"KzQGq29NOA+7nQRBSTTP1N53R6mISo8yQLtBb82EdYJ4azpdJbMgqrOji3uUelZcpuYDShBU4AaWxvpw",
	"Eij6oLmXcVcvPSWGtHsPSz3X2TUhHseczRmJ/YoV8JQpsan4vx2gunsLmTQY5XHbICY0mpMwFCDlsZtp",
	"curOiAckourIO3KxIoz+RqzcTt1JonnKqDoOgdYLOGbLdo8uZoFqRzn+Ao7te7iFecA8mA81fAeJ1+br",
	"CcxJUYzKeUCclQXnERD2eyPXH+cX65cocfuYMmGCR1EMTF0DCylbNcd4kIrGREE414RFkNtb1W1Ociik",
	"lcwEOZIkgj+YjOMwNYxBSm9eNgpDao01c8mIMotSr3uD5pcUpJrTcBfZHaNfUkBQcABl0IiGwDQPjXoV",
	"JKcpDb3xsiGAlKzdjR+JZbYnWNSk6VygOKldjjd2h0e7pWiPcjO6Yjq3vMnZwND15BJZBnTRZSoVWsCK",
	"MvRI1Rp9wuf63+vJu+kVGk9ubqdvp+PR7QTdTH66m8xuzeonjAgLEbCwsmly9aZlS/cTMwGVaDXDw4PO",
	"YZfT6fjft+Px6O7zePTT6PHHNxNy+Xr1btS/m4weH29++Xm9Xvz8Wv4yeykXg6v14t36IXj+0+Mn1u12",
	"P7H9ZLE9HrOZsRmQo1e6+EqlNQ/tNggLoHJlFclzCeLBLTwclSNszh9ACBrCPpcxG119yEEdT3vwdgvv",
	"onggEQ2p2sxDspG+9NaoD4QoB9SlD+WhVii9BZ3FZIMWgJRIWWB8xWKTM+mZy4bnr152cEyeaKzN5oeB",
	"/kWZ/dXfX/VIzbxcQvus5oDSZh+vpjoAhLUa+a/qgky0Ck/zQJUkew9nbZD/lvzVZx5cb2XApjTKY4jM",
	"vjdWXq4EjxBG3dt3sA2Fpl7Ij8SdZlEYc42p0kGXqMPzuDQJyXF7Tg07QnDxBhSh0a5klxQij9K/1Z+R",
	"WhOFApJKnSmsAYHGdFQyYM5G7jffrfwkN6tjaC5zeJvJ5YCvkjLXaqA94OFx+c+PaUzYuQASkkWU8Qzl",
	"0PtkaknxSXHXrg5JjZvjXSVx8F0w0Km4H8/bNIrc7hYysFWU6AyegijVNmVamF6r9bebqofNfhydD16+",
	"Qg4s4kujj65bcgPzqD98PRiOnw/fvBhOXg7fvhp2u92m+qso2Zp5VcRInSJltnlKgXfACVIRoY47Y6fo",
	"a+mRGNC8V3m2hqdzYFrDw0pIxxf90eD18/GLNy8nr97+Dft93jfqEe3WRg4TXZH5rOTaJhLtreos2zjc",
	"f2RYG1vUtRsV+FsobKaORBF/hHD+GTZzvduTMowsCPoMG0SiFRdUrWNpknhJfzPt48P7I5rRK24bGjvA",
	"lXM96/CkgIUZtWlDQZhRm8Masg3scYTa0L4DdsDJJx4Yk6f5njz60ua9TVm0d4zQ2D3UFUOmR3E+cNpT",
	"Ndy44E7lcBQau6eKqqbSJscwhLfodGNnzFWxPN9SkUl0Yx2TO1j7oLm0tS3u4JAHqSbE+RQQ3MFcrSuG",
	"36ioVSll9LXnIbmC+bdWcv1dN0/i/ZlAXmEa4H2JQDvD3Xpx59gPSdZ+yQSLRpECwYiiD4CuSAworyul",
	"Lb3czMrtRVfRvrmaGdKlrosp07HdZBEtgfhj/mc34NqRPz4+dt0v953f1++u5WsaABUAx5BJwpiyf5xM",
	"Wr2bXqVren0aUf2/D7r9Vz90+90+7uD+RVf/7x9HWSqoh6K7m+lRlKyVSuSw1zuRQVu/Bt/UfFSDJs6z",
	"gOjv55ZgpfX44Gra047UlWc7pOZvG4T36rVuTbMBZ94cvblCpk5rMVxn8lRL/+wCOhs/01EqPTIGuuOe",
	"KuL32Qo6e38S5vpIqMYDZxWdffjdJzijo+aDSITuGFXo7MPdSQcWo6ZaBaM/Iy7QteAPlAWAzma3JxzQ",
	"okzttpSnlFZJ6LEjv8yy5v7pp2MNJWChjM1AdfnvNx1T6wSpoGoz07mLvccCiAAxStW6/PU2L5z++a9b",
	"XEsO9DdEUrXWAT2bwSv+GXRKYFIiQ4VBU0Zp7QHxVlNA2ZJbg2OK2ALIMgSPrqdoliYJF2onI6lUYZpW",
	"nbNvkNP707uXXFTK6rzRaBpMUlLOOkUnuoMEaFk+kKhjM3/bKAvWEHymbNXNaZEoTiNFk6ji4PNsRGZB",
	"QJfpt+9nyPazO+bvIKLAVMe0QFCWidmzZr3L6eXEjgAiGkBWyOSMSEiwBjToXmDtIaOMfzqC6AyAmOUu",
	"F6tetlf23k/Hk6vZ5Fzv0YKnytSh41GNRbiDH0BIy9O+jojG0BNgJKF4iJ93L7rPzXMZtTba0au/S1qB",
	"8nUfDSsBERRRafoLtt9XfZdlpiM8985LqvMqzWpsSBBGl6ah9o1UqnH1PU9CBIlBgZB4+HG33aZRocXG",
	"JyLtITTQlxTEJs8Kh7hctYm8dyh72EFFx9h3Tjm6LY45cnTcRkYe4qxvMQkmOkuIUJRE9iXVsya6ykny",
	"USy4Lt+LGYNLyIqyfDjpZbRt3JVHhLAkaaTMeKN91HHUg7Oms+2zLy8Bgwtn9NK/uNhDz732vrbvYGxh",
	"cHGRuzJgxixIkkSZU+z9mjXqj5Z7pftinGYtc8hMrGKaxrvnBaQFqb+IIyttO7hiWPd6X8XIe19tR8ny",
	"enuIzcsEAr29YhSLDaJKVltmu5b+DlxD32fnh/fijDJoL+YovHMt7FaLSqTQZgLfSeyOyDsVjE/nCcTn",
	"+Qi2xFu0NxeUEaP1dcpbw2gW/yDUIeDFxYs/7E7V6cMeKhhXaMlTFtY0+B2oujpVJH6yQvdMs32/WuuK",
	"bulv1JsHH+73jpMFkChC2mWIGEKq94xHEqWJrhfPFqkyFy6gn5ljBOfKJgNtxmHe9vxPW0j1nfh3MhMr",
	"8v8uYwkyVWmxEDuPN7UOlx47mJmhbFXN8yS2SKzPxrObZ5k5MHh0Ybvodl1m4HEqVdEuIbbdi8azm9rM",
	"y+ThJphsjGGEILUC+rI6n71YmsuMFxdz7dc83PxxItt5h7Stth+1uWx3TKL/TQhoVhwn8ydBAImC0DDY",
	"ZWY2ld928OBi8A3oqz+4O5DM7DFB+arOGN3F9zO6KbMqKnIBd/CLweA7Gv3sxhqJra+XhEZQN/rMQl1x",
	"7j6ycZyAYxeuC+h9zUCn4fawqJhVynyJSCGp3ZO9uV79ycy+cDbZ82rIE8SK27RGsD0vXL5pRGt8N9Ru",
	"HRnb/7xI5BFGW0DyvPgqauFGnXRny/s1MdqthMrGDHkgNDKTIx2gSmr87Ybr/OBvKHjfdL2lvit44ant",
	"ysv57u5wuLhXlb+9r9lfB1m9fTAEofsUGZEFT1VT9ZdHaZ8TuC46L6227x0degy+uMhfJmWtv1HwyLgc",
	"qZqnWH+iVeeUHJpbJlXKG1TN6TUb0bpd5o/3mvu2U+qtYUamm7sgElAmatsF7ZGE9h76vYBgjSE7t60E",
	"cnxQoYayVB3H/ew2mzy1Mom8aCrpdTuinHs+NAX/tvfb/wQAAP//YBGT7zk7AAA=",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
