// Package server provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.4.1-0.20250618140738-aae687ce8fe9 DO NOT EDIT.
package server

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"
	"time"

	"github.com/getkin/kin-openapi/openapi3"
	"github.com/gofiber/fiber/v2"
	"github.com/oapi-codegen/runtime"
	openapi_types "github.com/oapi-codegen/runtime/types"
)

const (
	BearerAuthScopes = "bearerAuth.Scopes"
)

// Defines values for CAResponseStatus.
const (
	CAResponseStatusActive   CAResponseStatus = "active"
	CAResponseStatusInactive CAResponseStatus = "inactive"
	CAResponseStatusPending  CAResponseStatus = "pending"
)

// Defines values for CAResponseType.
const (
	CAResponseTypeIntermediate CAResponseType = "intermediate"
	CAResponseTypeRoot         CAResponseType = "root"
)

// Defines values for CASummaryStatus.
const (
	CASummaryStatusActive   CASummaryStatus = "active"
	CASummaryStatusInactive CASummaryStatus = "inactive"
	CASummaryStatusPending  CASummaryStatus = "pending"
)

// Defines values for CASummaryType.
const (
	CASummaryTypeIntermediate CASummaryType = "intermediate"
	CASummaryTypeRoot         CASummaryType = "root"
)

// Defines values for CertificateStatus.
const (
	CertificateStatusActive  CertificateStatus = "active"
	CertificateStatusExpired CertificateStatus = "expired"
	CertificateStatusRevoked CertificateStatus = "revoked"
)

// Defines values for EnrollmentPendingResponseStatus.
const (
	EnrollmentPendingResponseStatusPending EnrollmentPendingResponseStatus = "pending"
)

// Defines values for EnrollmentResponseStatus.
const (
	Issued EnrollmentResponseStatus = "issued"
)

// Defines values for EnrollmentStatusResponseStatus.
const (
	EnrollmentStatusResponseStatusApproved EnrollmentStatusResponseStatus = "approved"
	EnrollmentStatusResponseStatusIssued   EnrollmentStatusResponseStatus = "issued"
	EnrollmentStatusResponseStatusPending  EnrollmentStatusResponseStatus = "pending"
	EnrollmentStatusResponseStatusRejected EnrollmentStatusResponseStatus = "rejected"
)

// Defines values for ProfileSummaryCategory.
const (
	CA              ProfileSummaryCategory = "ca"
	CodeSigning     ProfileSummaryCategory = "code_signing"
	DocumentSigning ProfileSummaryCategory = "document_signing"
	Email           ProfileSummaryCategory = "email"
	Other           ProfileSummaryCategory = "other"
	TLS             ProfileSummaryCategory = "tls"
)

// Defines values for RevocationReason.
const (
	AaCompromise         RevocationReason = "aa_compromise"
	AffiliationChanged   RevocationReason = "affiliation_changed"
	CACompromise         RevocationReason = "ca_compromise"
	CertificateHold      RevocationReason = "certificate_hold"
	CessationOfOperation RevocationReason = "cessation_of_operation"
	KeyCompromise        RevocationReason = "key_compromise"
	PrivilegeWithdrawn   RevocationReason = "privilege_withdrawn"
	RemoveFromCRL        RevocationReason = "remove_from_crl"
	Superseded           RevocationReason = "superseded"
	Unspecified          RevocationReason = "unspecified"
)

// Defines values for RevocationResponseStatus.
const (
	RevocationResponseStatusRevoked RevocationResponseStatus = "revoked"
)

// Defines values for GetCRLParamsFormat.
const (
	DER GetCRLParamsFormat = "der"
	PEM GetCRLParamsFormat = "pem"
)

// CAListResponse defines model for CAListResponse.
type CAListResponse struct {
	// Authorities List of available Certificate Authorities
	Authorities []CASummary `json:"authorities"`
}

// CAResponse defines model for CAResponse.
type CAResponse struct {
	// CertificatePEM CA certificate in PEM format
	CertificatePEM string `json:"certificate_pem"`

	// ChainPEM Certificate chain in PEM format (excludes root)
	ChainPEM *[]string `json:"chain_pem,omitempty"`

	// CRLDistributionPoints CRL distribution point URLs
	CRLDistributionPoints *[]string `json:"crl_distribution_points,omitempty"`

	// ID Unique identifier for the CA
	ID     string              `json:"id"`
	Issuer *CertificateSubject `json:"issuer,omitempty"`

	// IssuingUrls CA issuers URLs (AIA)
	IssuingUrls *[]string `json:"issuing_urls,omitempty"`

	// KeyAlgorithm Key algorithm (RSA, ECDSA, EdDSA)
	KeyAlgorithm *string `json:"key_algorithm,omitempty"`

	// KeySize Key size in bits
	KeySize *int `json:"key_size,omitempty"`

	// Name Human-readable name of the CA
	Name string `json:"name"`

	// NotAfter End of validity period
	NotAfter *time.Time `json:"not_after,omitempty"`

	// NotBefore Start of validity period
	NotBefore *time.Time `json:"not_before,omitempty"`

	// OCSPUrls OCSP responder URLs
	OCSPUrls *[]string `json:"ocsp_urls,omitempty"`

	// PathLength Maximum path length for certificate chain
	PathLength *int `json:"path_length,omitempty"`

	// SerialNumber Serial number of the CA certificate (hex-encoded)
	SerialNumber *string `json:"serial_number,omitempty"`

	// SignatureAlgorithm Signature algorithm used
	SignatureAlgorithm *string `json:"signature_algorithm,omitempty"`

	// Status Current operational status
	Status  CAResponseStatus    `json:"status"`
	Subject *CertificateSubject `json:"subject,omitempty"`

	// Type Type of CA
	Type CAResponseType `json:"type"`
}

// CAResponseStatus Current operational status
type CAResponseStatus string

// CAResponseType Type of CA
type CAResponseType string

// CASummary defines model for CASummary.
type CASummary struct {
	// ID Unique identifier for the CA
	ID string `json:"id"`

	// Name Human-readable name of the CA
	Name string `json:"name"`

	// Status Current operational status
	Status CASummaryStatus `json:"status"`

	// SubjectCN Subject Common Name from the CA certificate
	SubjectCN *string `json:"subject_cn,omitempty"`

	// Type Type of CA
	Type CASummaryType `json:"type"`

	// ValidUntil Expiration time of the CA certificate
	ValidUntil *time.Time `json:"valid_until,omitempty"`
}

// CASummaryStatus Current operational status
type CASummaryStatus string

// CASummaryType Type of CA
type CASummaryType string

// CertificateChainResponse defines model for CertificateChainResponse.
type CertificateChainResponse struct {
	// Certificates Chain certificates from leaf to root
	Certificates []ChainCertificate `json:"certificates"`
}

// CertificateListResponse defines model for CertificateListResponse.
type CertificateListResponse struct {
	Certificates []CertificateSummary `json:"certificates"`

	// Page Current page number
	Page int `json:"page"`

	// PageSize Number of results per page
	PageSize int `json:"page_size"`

	// Total Total number of matching certificates
	Total int `json:"total"`
}

// CertificateResponse defines model for CertificateResponse.
type CertificateResponse struct {
	CertificatePEM    string              `json:"certificate_pem"`
	FingerprintSha256 *string             `json:"fingerprint_sha256,omitempty"`
	Issuer            *CertificateSubject `json:"issuer,omitempty"`
	NotAfter          *time.Time          `json:"not_after,omitempty"`
	NotBefore         *time.Time          `json:"not_before,omitempty"`
	Profile           *string             `json:"profile,omitempty"`

	// RevocationReason Reason for revocation (if revoked)
	RevocationReason *string `json:"revocation_reason,omitempty"`

	// RevocationTime Time of revocation (if revoked)
	RevocationTime *time.Time `json:"revocation_time,omitempty"`
	SerialNumber   string     `json:"serial_number"`

	// Status Certificate status
	Status  CertificateStatus   `json:"status"`
	Subject *CertificateSubject `json:"subject,omitempty"`
}

// CertificateStatus Certificate status
type CertificateStatus string

// CertificateSubject defines model for CertificateSubject.
type CertificateSubject struct {
	CommonName         *string   `json:"common_name,omitempty"`
	Country            *[]string `json:"country,omitempty"`
	DNSNames           *[]string `json:"dns_names,omitempty"`
	EmailAddresses     *[]string `json:"email_addresses,omitempty"`
	IPAddresses        *[]string `json:"ip_addresses,omitempty"`
	Locality           *[]string `json:"locality,omitempty"`
	Organization       *[]string `json:"organization,omitempty"`
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`
	State              *[]string `json:"state,omitempty"`
}

// CertificateSummary defines model for CertificateSummary.
type CertificateSummary struct {
	NotAfter     *time.Time `json:"not_after,omitempty"`
	NotBefore    *time.Time `json:"not_before,omitempty"`
	Profile      *string    `json:"profile,omitempty"`
	SerialNumber string     `json:"serial_number"`

	// Status Certificate status
	Status    CertificateStatus `json:"status"`
	SubjectCN string            `json:"subject_cn"`
}

// ChainCertificate defines model for ChainCertificate.
type ChainCertificate struct {
	CertificatePEM string              `json:"certificate_pem"`
	IsCA           *bool               `json:"is_ca,omitempty"`
	Issuer         *CertificateSubject `json:"issuer,omitempty"`
	Subject        CertificateSubject  `json:"subject"`
}

// EnrollmentPendingResponse defines model for EnrollmentPendingResponse.
type EnrollmentPendingResponse struct {
	// EstimatedCompletion Estimated time for approval
	EstimatedCompletion *time.Time `json:"estimated_completion,omitempty"`

	// Message Additional status information
	Message *string `json:"message,omitempty"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentPendingResponseStatus `json:"status"`
}

// EnrollmentPendingResponseStatus Enrollment status
type EnrollmentPendingResponseStatus string

// EnrollmentRequest defines model for EnrollmentRequest.
type EnrollmentRequest struct {
	// CSR Certificate Signing Request in PEM format. Must begin with "-----BEGIN CERTIFICATE REQUEST-----" and end with "-----END CERTIFICATE REQUEST-----".
	CSR string `json:"csr"`

	// Profile Certificate profile identifier to use for issuance
	Profile string `json:"profile"`

	// SANOverride Optional Subject Alternative Name overrides
	SANOverride *SANOverride `json:"san_override,omitempty"`

	// SubjectOverride Optional subject DN field overrides
	SubjectOverride *SubjectOverride `json:"subject_override,omitempty"`

	// ValidityDays Requested validity period in days (may be truncated by profile)
	ValidityDays *int `json:"validity_days,omitempty"`
}

// EnrollmentResponse defines model for EnrollmentResponse.
type EnrollmentResponse struct {
	Certificate IssuedCertificate `json:"certificate"`

	// RequestID Unique enrollment request identifier
	RequestID openapi_types.UUID `json:"request_id"`

	// Status Enrollment status
	Status EnrollmentResponseStatus `json:"status"`
}

// EnrollmentResponseStatus Enrollment status
type EnrollmentResponseStatus string

// EnrollmentStatusResponse defines model for EnrollmentStatusResponse.
type EnrollmentStatusResponse struct {
	Certificate *IssuedCertificate `json:"certificate,omitempty"`

	// RejectionReason Reason for rejection (if status is rejected)
	RejectionReason *string                        `json:"rejection_reason,omitempty"`
	RequestID       openapi_types.UUID             `json:"request_id"`
	Status          EnrollmentStatusResponseStatus `json:"status"`
	SubmittedAt     *time.Time                     `json:"submitted_at,omitempty"`
	UpdatedAt       *time.Time                     `json:"updated_at,omitempty"`
}

// EnrollmentStatusResponseStatus defines model for EnrollmentStatusResponse.Status.
type EnrollmentStatusResponseStatus string

// ErrorDetail defines model for ErrorDetail.
type ErrorDetail struct {
	// Field Field that caused the error
	Field *string `json:"field,omitempty"`

	// Message Error description
	Message *string `json:"message,omitempty"`
}

// ErrorResponse defines model for ErrorResponse.
type ErrorResponse struct {
	Details *[]ErrorDetail `json:"details,omitempty"`

	// Error Error code
	Error string `json:"error"`

	// Message Human-readable error message
	Message *string `json:"message,omitempty"`
}

// IssuedCertificate defines model for IssuedCertificate.
type IssuedCertificate struct {
	// CertificatePEM Certificate in PEM format
	CertificatePEM string `json:"certificate_pem"`

	// ChainPEM Full certificate chain in PEM format (excluding root)
	ChainPEM *string `json:"chain_pem,omitempty"`

	// FingerprintSha256 SHA-256 fingerprint of the certificate
	FingerprintSha256 *string `json:"fingerprint_sha256,omitempty"`

	// NotAfter Certificate validity end time
	NotAfter time.Time `json:"not_after"`

	// NotBefore Certificate validity start time
	NotBefore time.Time `json:"not_before"`

	// SerialNumber Certificate serial number (hex-encoded)
	SerialNumber string              `json:"serial_number"`
	Subject      *CertificateSubject `json:"subject,omitempty"`
}

// ProfileListResponse defines model for ProfileListResponse.
type ProfileListResponse struct {
	Profiles []ProfileSummary `json:"profiles"`
}

// ProfileResponse defines model for ProfileResponse.
type ProfileResponse struct {
	// AllowedKeyTypes Allowed key algorithms and sizes
	AllowedKeyTypes *[]string `json:"allowed_key_types,omitempty"`
	Category        *string   `json:"category,omitempty"`
	Description     *string   `json:"description,omitempty"`

	// ExtendedKeyUsage Allowed extended key usages
	ExtendedKeyUsage *[]string `json:"extended_key_usage,omitempty"`
	ID               string    `json:"id"`

	// KeyUsage Allowed key usages
	KeyUsage *[]string `json:"key_usage,omitempty"`

	// MaxValidityDays Maximum validity period in days
	MaxValidityDays     *int                 `json:"max_validity_days,omitempty"`
	Name                string               `json:"name"`
	SANRequirements     *SANRequirements     `json:"san_requirements,omitempty"`
	SubjectRequirements *SubjectRequirements `json:"subject_requirements,omitempty"`
}

// ProfileSummary defines model for ProfileSummary.
type ProfileSummary struct {
	Category *ProfileSummaryCategory `json:"category,omitempty"`

	// Description Profile description
	Description *string `json:"description,omitempty"`

	// ID Profile identifier
	ID string `json:"id"`

	// Name Human-readable profile name
	Name string `json:"name"`
}

// ProfileSummaryCategory defines model for ProfileSummary.Category.
type ProfileSummaryCategory string

// RevocationReason RFC 5280 CRLReason enumeration
type RevocationReason string

// RevocationRequest defines model for RevocationRequest.
type RevocationRequest struct {
	// Comment Optional comment explaining the reason for revocation
	Comment *string `json:"comment,omitempty"`

	// Reason RFC 5280 CRLReason enumeration
	Reason RevocationReason `json:"reason"`
}

// RevocationResponse defines model for RevocationResponse.
type RevocationResponse struct {
	// Message Human-readable confirmation message
	Message *string `json:"message,omitempty"`

	// Reason RFC 5280 CRLReason enumeration
	Reason RevocationReason `json:"reason"`

	// RevokedAt Time when the certificate was revoked
	RevokedAt time.Time `json:"revoked_at"`

	// SerialNumber Serial number of the revoked certificate
	SerialNumber string `json:"serial_number"`

	// Status Certificate status (always 'revoked')
	Status RevocationResponseStatus `json:"status"`
}

// RevocationResponseStatus Certificate status (always 'revoked')
type RevocationResponseStatus string

// SANOverride Optional Subject Alternative Name overrides
type SANOverride struct {
	// DNSNames DNS names to include in the certificate
	DNSNames *[]string `json:"dns_names,omitempty"`

	// EmailAddresses Email addresses to include in the certificate
	EmailAddresses *[]string `json:"email_addresses,omitempty"`

	// IPAddresses IP addresses to include in the certificate
	IPAddresses *[]string `json:"ip_addresses,omitempty"`

	// Uris URIs to include in the certificate
	Uris *[]string `json:"uris,omitempty"`
}

// SANRequirements defines model for SANRequirements.
type SANRequirements struct {
	DNSNamesAllowed       *bool `json:"dns_names_allowed,omitempty"`
	DNSNamesRequired      *bool `json:"dns_names_required,omitempty"`
	EmailAddressesAllowed *bool `json:"email_addresses_allowed,omitempty"`
	IPAddressesAllowed    *bool `json:"ip_addresses_allowed,omitempty"`
	UrisAllowed           *bool `json:"uris_allowed,omitempty"`
}

// SubjectOverride Optional subject DN field overrides
type SubjectOverride struct {
	// Country Country (C) values
	Country *[]string `json:"country,omitempty"`

	// Locality Locality (L) values
	Locality *[]string `json:"locality,omitempty"`

	// Organization Organization (O) values
	Organization *[]string `json:"organization,omitempty"`

	// OrganizationalUnit Organizational Unit (OU) values
	OrganizationalUnit *[]string `json:"organizational_unit,omitempty"`

	// State State or Province (ST) values
	State *[]string `json:"state,omitempty"`
}

// SubjectRequirements defines model for SubjectRequirements.
type SubjectRequirements struct {
	AllowedCountries    *[]string `json:"allowed_countries,omitempty"`
	RequireCommonName   *bool     `json:"require_common_name,omitempty"`
	RequireCountry      *bool     `json:"require_country,omitempty"`
	RequireOrganization *bool     `json:"require_organization,omitempty"`
}

// GetCRLParams defines parameters for GetCRL.
type GetCRLParams struct {
	// Format Output format for CRL
	Format *GetCRLParamsFormat `form:"format,omitempty" json:"format,omitempty"`
}

// GetCRLParamsFormat defines parameters for GetCRL.
type GetCRLParamsFormat string

// ListCertificatesParams defines parameters for ListCertificates.
type ListCertificatesParams struct {
	// Profile Filter by certificate profile
	Profile *string `form:"profile,omitempty" json:"profile,omitempty"`

	// Status Filter by certificate status
	Status *CertificateStatus `form:"status,omitempty" json:"status,omitempty"`

	// SubjectCN Filter by subject common name (partial match)
	SubjectCN *string `form:"subject_cn,omitempty" json:"subject_cn,omitempty"`

	// Page Page number for pagination
	Page *int `form:"page,omitempty" json:"page,omitempty"`

	// PageSize Number of results per page
	PageSize *int `form:"page_size,omitempty" json:"page_size,omitempty"`
}

// RevokeCertificateJSONRequestBody defines body for RevokeCertificate for application/json ContentType.
type RevokeCertificateJSONRequestBody = RevocationRequest

// SubmitEnrollmentJSONRequestBody defines body for SubmitEnrollment for application/json ContentType.
type SubmitEnrollmentJSONRequestBody = EnrollmentRequest

// ServerInterface represents all server handlers.
type ServerInterface interface {
	// List available Certificate Authorities
	// (GET /ca)
	ListCAs(c *fiber.Ctx) error
	// Get Certificate Authority details
	// (GET /ca/{caId})
	GetCA(c *fiber.Ctx, caid string) error
	// Download Certificate Revocation List
	// (GET /ca/{caId}/crl)
	GetCRL(c *fiber.Ctx, caid string, params GetCRLParams) error
	// List certificates
	// (GET /certificates)
	ListCertificates(c *fiber.Ctx, params ListCertificatesParams) error
	// Get certificate by serial number
	// (GET /certificates/{serialNumber})
	GetCertificate(c *fiber.Ctx, serialNumber string) error
	// Get certificate chain
	// (GET /certificates/{serialNumber}/chain)
	GetCertificateChain(c *fiber.Ctx, serialNumber string) error
	// Revoke a certificate
	// (POST /certificates/{serialNumber}/revoke)
	RevokeCertificate(c *fiber.Ctx, serialNumber string) error
	// Submit certificate enrollment request
	// (POST /enroll)
	SubmitEnrollment(c *fiber.Ctx) error
	// Get enrollment request status
	// (GET /enroll/{requestId})
	GetEnrollmentStatus(c *fiber.Ctx, requestID openapi_types.UUID) error
	// Get CA certificates
	// (GET /est/cacerts)
	EstCACerts(c *fiber.Ctx) error
	// Get CSR attributes
	// (GET /est/csrattrs)
	EstCSRAttrs(c *fiber.Ctx) error
	// Server-side key generation
	// (POST /est/serverkeygen)
	EstServerKeyGen(c *fiber.Ctx) error
	// Simple enrollment
	// (POST /est/simpleenroll)
	EstSimpleEnroll(c *fiber.Ctx) error
	// Simple re-enrollment
	// (POST /est/simplereenroll)
	EstSimpleReenroll(c *fiber.Ctx) error
	// OCSP responder endpoint
	// (POST /ocsp)
	HandleOCSP(c *fiber.Ctx) error
	// List available certificate profiles
	// (GET /profiles)
	ListProfiles(c *fiber.Ctx) error
	// Get certificate profile details
	// (GET /profiles/{profileId})
	GetProfile(c *fiber.Ctx, profileID string) error
	// Request timestamp
	// (POST /tsa/timestamp)
	TsaTimestamp(c *fiber.Ctx) error
}

// ServerInterfaceWrapper converts contexts to parameters.
type ServerInterfaceWrapper struct {
	Handler ServerInterface
}

type MiddlewareFunc fiber.Handler

// ListCAs operation middleware
func (siw *ServerInterfaceWrapper) ListCAs(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.ListCAs(c)
}

// GetCA operation middleware
func (siw *ServerInterfaceWrapper) GetCA(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "caId" -------------
	var caid string

	err = runtime.BindStyledParameterWithOptions("simple", "caId", c.Params("caId"), &caid, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter caId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCA(c, caid)
}

// GetCRL operation middleware
func (siw *ServerInterfaceWrapper) GetCRL(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "caId" -------------
	var caid string

	err = runtime.BindStyledParameterWithOptions("simple", "caId", c.Params("caId"), &caid, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter caId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params GetCRLParams

	var query url.Values
	query, err = url.ParseQuery(string(c.Request().URI().QueryString()))
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for query string: %w", err).Error())
	}

	// ------------- Optional query parameter "format" -------------

	err = runtime.BindQueryParameter("form", true, false, "format", query, &params.Format)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter format: %w", err).Error())
	}

	return siw.Handler.GetCRL(c, caid, params)
}

// ListCertificates operation middleware
func (siw *ServerInterfaceWrapper) ListCertificates(c *fiber.Ctx) error {

	var err error

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	// Parameter object where we will unmarshal all parameters from the context
	var params ListCertificatesParams

	var query url.Values
	query, err = url.ParseQuery(string(c.Request().URI().QueryString()))
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for query string: %w", err).Error())
	}

	// ------------- Optional query parameter "profile" -------------

	err = runtime.BindQueryParameter("form", true, false, "profile", query, &params.Profile)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profile: %w", err).Error())
	}

	// ------------- Optional query parameter "status" -------------

	err = runtime.BindQueryParameter("form", true, false, "status", query, &params.Status)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter status: %w", err).Error())
	}

	// ------------- Optional query parameter "subject_cn" -------------

	err = runtime.BindQueryParameter("form", true, false, "subject_cn", query, &params.SubjectCN)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter subject_cn: %w", err).Error())
	}

	// ------------- Optional query parameter "page" -------------

	err = runtime.BindQueryParameter("form", true, false, "page", query, &params.Page)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page: %w", err).Error())
	}

	// ------------- Optional query parameter "page_size" -------------

	err = runtime.BindQueryParameter("form", true, false, "page_size", query, &params.PageSize)
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter page_size: %w", err).Error())
	}

	return siw.Handler.ListCertificates(c, params)
}

// GetCertificate operation middleware
func (siw *ServerInterfaceWrapper) GetCertificate(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificate(c, serialNumber)
}

// GetCertificateChain operation middleware
func (siw *ServerInterfaceWrapper) GetCertificateChain(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetCertificateChain(c, serialNumber)
}

// RevokeCertificate operation middleware
func (siw *ServerInterfaceWrapper) RevokeCertificate(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "serialNumber" -------------
	var serialNumber string

	err = runtime.BindStyledParameterWithOptions("simple", "serialNumber", c.Params("serialNumber"), &serialNumber, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter serialNumber: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.RevokeCertificate(c, serialNumber)
}

// SubmitEnrollment operation middleware
func (siw *ServerInterfaceWrapper) SubmitEnrollment(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.SubmitEnrollment(c)
}

// GetEnrollmentStatus operation middleware
func (siw *ServerInterfaceWrapper) GetEnrollmentStatus(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "requestId" -------------
	var requestID openapi_types.UUID

	err = runtime.BindStyledParameterWithOptions("simple", "requestId", c.Params("requestId"), &requestID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter requestId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetEnrollmentStatus(c, requestID)
}

// EstCACerts operation middleware
func (siw *ServerInterfaceWrapper) EstCACerts(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.EstCACerts(c)
}

// EstCSRAttrs operation middleware
func (siw *ServerInterfaceWrapper) EstCSRAttrs(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.EstCSRAttrs(c)
}

// EstServerKeyGen operation middleware
func (siw *ServerInterfaceWrapper) EstServerKeyGen(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.EstServerKeyGen(c)
}

// EstSimpleEnroll operation middleware
func (siw *ServerInterfaceWrapper) EstSimpleEnroll(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.EstSimpleEnroll(c)
}

// EstSimpleReenroll operation middleware
func (siw *ServerInterfaceWrapper) EstSimpleReenroll(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.EstSimpleReenroll(c)
}

// HandleOCSP operation middleware
func (siw *ServerInterfaceWrapper) HandleOCSP(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.HandleOCSP(c)
}

// ListProfiles operation middleware
func (siw *ServerInterfaceWrapper) ListProfiles(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.ListProfiles(c)
}

// GetProfile operation middleware
func (siw *ServerInterfaceWrapper) GetProfile(c *fiber.Ctx) error {

	var err error

	// ------------- Path parameter "profileId" -------------
	var profileID string

	err = runtime.BindStyledParameterWithOptions("simple", "profileId", c.Params("profileId"), &profileID, runtime.BindStyledParameterOptions{Explode: false, Required: true})
	if err != nil {
		return fiber.NewError(fiber.StatusBadRequest, fmt.Errorf("Invalid format for parameter profileId: %w", err).Error())
	}

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.GetProfile(c, profileID)
}

// TsaTimestamp operation middleware
func (siw *ServerInterfaceWrapper) TsaTimestamp(c *fiber.Ctx) error {

	c.Context().SetUserValue(BearerAuthScopes, []string{})

	return siw.Handler.TsaTimestamp(c)
}

// FiberServerOptions provides options for the Fiber server.
type FiberServerOptions struct {
	BaseURL     string
	Middlewares []MiddlewareFunc
}

// RegisterHandlers creates http.Handler with routing matching OpenAPI spec.
func RegisterHandlers(router fiber.Router, si ServerInterface) {
	RegisterHandlersWithOptions(router, si, FiberServerOptions{})
}

// RegisterHandlersWithOptions creates http.Handler with additional options
func RegisterHandlersWithOptions(router fiber.Router, si ServerInterface, options FiberServerOptions) {
	wrapper := ServerInterfaceWrapper{
		Handler: si,
	}

	for _, m := range options.Middlewares {
		router.Use(fiber.Handler(m))
	}

	router.Get(options.BaseURL+"/ca", wrapper.ListCAs)

	router.Get(options.BaseURL+"/ca/:caId", wrapper.GetCA)

	router.Get(options.BaseURL+"/ca/:caId/crl", wrapper.GetCRL)

	router.Get(options.BaseURL+"/certificates", wrapper.ListCertificates)

	router.Get(options.BaseURL+"/certificates/:serialNumber", wrapper.GetCertificate)

	router.Get(options.BaseURL+"/certificates/:serialNumber/chain", wrapper.GetCertificateChain)

	router.Post(options.BaseURL+"/certificates/:serialNumber/revoke", wrapper.RevokeCertificate)

	router.Post(options.BaseURL+"/enroll", wrapper.SubmitEnrollment)

	router.Get(options.BaseURL+"/enroll/:requestId", wrapper.GetEnrollmentStatus)

	router.Get(options.BaseURL+"/est/cacerts", wrapper.EstCACerts)

	router.Get(options.BaseURL+"/est/csrattrs", wrapper.EstCSRAttrs)

	router.Post(options.BaseURL+"/est/serverkeygen", wrapper.EstServerKeyGen)

	router.Post(options.BaseURL+"/est/simpleenroll", wrapper.EstSimpleEnroll)

	router.Post(options.BaseURL+"/est/simplereenroll", wrapper.EstSimpleReenroll)

	router.Post(options.BaseURL+"/ocsp", wrapper.HandleOCSP)

	router.Get(options.BaseURL+"/profiles", wrapper.ListProfiles)

	router.Get(options.BaseURL+"/profiles/:profileId", wrapper.GetProfile)

	router.Post(options.BaseURL+"/tsa/timestamp", wrapper.TsaTimestamp)

}

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"1lUdZULUmi7J6uHzw/8HAAD//70bwP2TbwAA",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
