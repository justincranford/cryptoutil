---
description: "Platform-specific tooling"
applyTo: "**"
---
# Cross Platform

# Platform-Specific Tooling - Tactical Guidance

## autoapprove Wrapper

Bypasses VS Code Copilot's hardcoded safety blockers for loopback network commands.

**Usage** (Local Chat Agent sessions only):

```bash
autoapprove curl https://127.0.0.1:9090/admin/v1/livez
autoapprove go test ./...
```

**Security**: Only allows loopback addresses (127.0.0.1, ::1, localhost)
**Logs**: Creates timestamped directories in `./test-output/autoapprove/`

## HTTP Commands

**Local Chat**: `autoapprove curl` | **GitHub Actions**: `curl` directly | **Docker healthchecks**: `wget`
**NEVER use `Invoke-WebRequest`** (blocked by VS Code)

## Cross-Platform Scripts

**Preference order**: Go > Python > (BANNED: PowerShell/Bash scripts)

**Go**: Cross-platform, complex logic, performance-critical, static compilation
**Python**: When Go not suitable, rapid prototyping, Python ecosystem integration

## Authorized Chat Session Commands

**Git**: `status`, `add`, `commit -m`, `log --oneline`, `diff`, `checkout`, `mv`
**Go**: `test`, `build`, `mod tidy`, `run`, `golangci-lint run`, `-fuzz`
**Docker**: `compose ps/logs/exec/build/up/down`, `inspect`, `ps`, `stats`
**File ops**: `pwd`, `ls -la`, `dir`, `mkdir`, `cat`, `type`, `head`, `tail`, `grep`

**Requires manual auth**: `cd`, `Set-Location`, network commands without autoapprove

## Docker Image Pre-Pull

Use `.github/actions/docker-images-pull` for parallel image downloads:

```yaml
- uses: ./.github/actions/docker-images-pull
  with:
    images: |
      postgres:18
      alpine:3.19
```

## PowerShell Notes

- Use `;` to chain commands (not `&&`)
- No `sed` - use `git diff` or `Get-Content | Select-String`

## autoapprove Wrapper - Security Tool

### Purpose

**Bypasses VS Code Copilot's hardcoded safety blockers for loopback network commands**

**Problem**: VS Code Copilot blocks HTTPS curl commands to 127.0.0.1/localhost by default, even for local development servers

**Solution**: `autoapprove` wrapper allows loopback-only commands after security validation

### Usage Pattern (Local Chat Agent Sessions Only)

**Allowed Commands**:

```bash
# Health checks
autoapprove curl https://127.0.0.1:9090/admin/v1/livez
autoapprove curl https://localhost:8080/ui/swagger/doc.json

# Testing
autoapprove go test ./...
autoapprove golangci-lint run

# Database queries
autoapprove psql -h 127.0.0.1 -U postgres -d cryptoutil

# Docker commands
autoapprove docker exec cryptoutil-sqlite wget https://127.0.0.1:8080/api
```

### Security Restrictions

**ONLY loopback**: `127.0.0.1`, `::1`, `localhost` - NO external IPs
**Logging**: Timestamped audit trail in `./test-output/autoapprove/`

---

## HTTP Commands by Environment - Decision Matrix

| Environment | Tool | Example | Rationale |
|-------------|------|---------|-----------|
| Local Chat (VS Code) | `autoapprove curl` | `autoapprove curl -s http://127.0.0.1:8080/api` | Bypasses Copilot safety blockers |
| GitHub Actions | `curl` directly | `curl -s http://127.0.0.1:8080/api` | No safety blockers in CI/CD |
| Docker healthchecks | `wget` | `wget --no-check-certificate -q -O /dev/null https://127.0.0.1:9090/admin/v1/livez` | Available in Alpine, lighter than curl |

**NEVER use `Invoke-WebRequest`**:

- ❌ PowerShell cmdlet blocked by VS Code safety overrides
- ❌ Slower than curl/wget
- ❌ More verbose syntax
- ✅ Use `autoapprove curl` instead

---

## Cross-Platform Script Language Preference

**Order**: 1. Go (preferred), 2. Python (acceptable), 3. PowerShell/Bash (BANNED for new scripts)

**Go**: Cross-platform, static binary, complex logic, CI/CD utilities
**Python**: Rapid prototyping, data processing, ecosystem integration
**PowerShell/Bash**: LEGACY ONLY - convert to Go when modifying

---

## Authorized Chat Session Commands

**Auto-Approved**: git (status, log, diff, add, commit), go (test, build, mod tidy, golangci-lint), docker (compose ps/logs/exec/up/down), file ops (ls, cat, grep, mkdir)

**Manual Authorization**: cd, curl/wget (use autoapprove for loopback)

**BANNED**: `Invoke-WebRequest` (use autoapprove curl instead)

---

## Docker Image Pre-Pull Action

**Usage**: `.github/actions/docker-images-pull` for E2E tests, matrix workflows

---

## PowerShell Syntax Notes

**Command Chaining**: Use `;` (NOT `&&`)
**Unix Utilities**: NOT available - use Git commands (git diff, git grep) or PowerShell (Select-String)
