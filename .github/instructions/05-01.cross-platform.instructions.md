---
description: "Platform-specific tooling"
applyTo: "**"
---
# Cross Platform

## autoapprove Wrapper

Bypasses VS Code Copilot's hardcoded safety blockers for loopback network commands.

**Usage** (Local Chat Agent sessions only):

```bash
autoapprove curl https://127.0.0.1:9090/admin/v1/livez
autoapprove go test ./...
```

**Security**: Only allows loopback addresses (127.0.0.1, ::1, localhost)
**Logs**: Creates timestamped directories in `./test-output/autoapprove/`

## HTTP Commands

**Local Chat**: `autoapprove curl` | **GitHub Actions**: `curl` directly | **Docker healthchecks**: `wget`
**NEVER use `Invoke-WebRequest`** (blocked by VS Code)

## Cross-Platform Scripts

**Preference order**: Go > Python > (BANNED: PowerShell/Bash scripts)

**Go**: Cross-platform, complex logic, performance-critical, static compilation
**Python**: When Go not suitable, rapid prototyping, Python ecosystem integration

## Authorized Chat Session Commands

**Git**: `status`, `add`, `commit -m`, `log --oneline`, `diff`, `checkout`, `mv`
**Go**: `test`, `build`, `mod tidy`, `run`, `golangci-lint run`, `-fuzz`
**Docker**: `compose ps/logs/exec/build/up/down`, `inspect`, `ps`, `stats`
**File ops**: `pwd`, `ls -la`, `dir`, `mkdir`, `cat`, `type`, `head`, `tail`, `grep`

**Requires manual auth**: `cd`, `Set-Location`, network commands without autoapprove

## Docker Desktop Startup - CRITICAL

**MANDATORY**: Docker Desktop MUST be running before executing any Docker-dependent operations (E2E tests, Docker Compose, container builds).

**Cross-Platform Verification**:

```bash
# Check if Docker is running (all platforms)
docker ps

# Expected: list of containers or empty table
# Error: "Cannot connect to the Docker daemon" = Docker not running
```

**Platform-Specific Startup**:

**Windows**:
```powershell
# Start Docker Desktop
Start-Process -FilePath "C:\Program Files\Docker\Docker\Docker Desktop.exe"

# Wait for initialization (30-60 seconds)
Start-Sleep -Seconds 45

# Verify Docker is ready
docker ps
```

**macOS**:
```bash
# Start Docker Desktop
open -a Docker

# Wait for initialization (30-60 seconds)
sleep 45

# Verify Docker is ready
docker ps
```

**Linux**:
```bash
# Start Docker service (systemd)
sudo systemctl start docker

# Enable Docker to start on boot
sudo systemctl enable docker

# Verify Docker is ready
docker ps

# Alternative: Docker Desktop for Linux (if installed)
systemctl --user start docker-desktop
```

**Why Critical**: All workflow testing infrastructure, E2E tests, and Docker Compose operations require Docker daemon. Without Docker running:
- `docker ps` fails with "Cannot connect to the Docker daemon" error
- `docker compose up` fails with pipe/socket errors
- E2E tests skip with environmental warnings
- Integration test containers cannot start

See [ARCHITECTURE.md Section 13.5.4 Docker Desktop Startup](../../docs/ARCHITECTURE.md#1354-docker-desktop-startup---critical) for comprehensive documentation.

## Docker Image Pre-Pull

Use `.github/actions/docker-images-pull` for parallel image downloads:

```yaml
- uses: ./.github/actions/docker-images-pull
  with:
    images: |
      postgres:18
      alpine:3.19
```

See [ARCHITECTURE.md Section 9.7 CI/CD Workflow Architecture](../../docs/ARCHITECTURE.md#97-cicd-workflow-architecture) for workflow optimization patterns including Docker image pre-pulling.

## PowerShell Notes

- Use `;` to chain commands (not `&&`)
- No `sed` - use `git diff` or `Get-Content | Select-String`
