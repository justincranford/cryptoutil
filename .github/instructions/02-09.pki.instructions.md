---
description: "Instructions for PKI, CA, certificate management, and CA/Browser Forum compliance"
applyTo: "**"
---
# PKI and Certificate Management - Tactical Guidance

**Reference**: See `.specify/memory/pki.md` for complete specifications (CA/Browser Forum Baseline Requirements, certificate profiles, CA architecture, key ceremonies, CT, OCSP, CAA)

**This file contains ONLY tactical implementation patterns**

## Quick Reference: Certificate Validation

```go
// ✅ CORRECT: Strict TLS configuration
tlsConfig := &tls.Config{
    MinVersion:         tls.VersionTLS13,
    InsecureSkipVerify: false,  // ALWAYS validate certs
    RootCAs:            certPool,
    ClientCAs:          certPool,
    ClientAuth:         tls.RequireAndVerifyClientCert,
}
```

## CA Architecture Quick Reference

| Configuration | Layers | Use Case |
|---------------|--------|----------|
| Offline→Online→Issuing | 3 | Maximum security (recommended) |
| Online→Issuing | 2 | Balanced security/operations |
| Online Root | 1 | Development/testing only |

## Certificate Compliance Checklist

**Subscriber Certificates**:
- ✅ Serial ≥64 bits CSPRNG, >0, <2^159
- ✅ RSA ≥2048, ECDSA P-256/384/521, EdDSA
- ✅ SHA-256/384/512 (NEVER MD5/SHA-1)
- ✅ Validity ≤398 days
- ✅ Extensions: Key Usage (critical), EKU, SAN, AKI, SKI
- ✅ CRL/OCSP URIs present
- ✅ Audit logs 7 years

**Validation**:
- ✅ DV: Within 30 days
- ✅ OV/EV: Within 13 months
- ✅ CAA checked before issuance

## Key Takeaways

1. **TLS 1.3+**: NEVER InsecureSkipVerify
2. **Serial Numbers**: ≥64 bits CSPRNG, unique per CA
3. **Validity**: ≤398 days for subscriber certificates
4. **Extensions**: Key Usage + EKU + SAN mandatory
5. **CT**: 2+ SCTs from different log operators (public CAs)
6. **CAA**: Check DNS CAA records before issuance
