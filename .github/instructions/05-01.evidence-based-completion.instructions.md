---
description: "Instructions for evidence-based task completion and validation"
applyTo: "**"
---
# Evidence-Based Task Completion Instructions

## CRITICAL: Evidence Required for Completion Claims

**NEVER mark tasks complete without objective evidence** - subjective "looks done" assessments cause gaps

### Mandatory Evidence Before Task Completion

**Code Evidence:**
- Zero compilation errors: `go build ./...` output clean
- Zero linting errors: `golangci-lint run ./...` output clean
- Zero TODOs in modified files: `grep -r "TODO\|FIXME" <files>` = 0 results
- Code coverage maintained/improved: ≥85% infrastructure, ≥80% features

**Test Evidence:**
- All tests pass: `runTests ./...` shows PASS (0 failures)
- Integration tests pass: E2E flow validated (documented)
- No test skips without issue tracking: `grep -r "t.Skip" <files>` = 0

**Requirements Evidence:**
- Requirements coverage: Tool shows ≥90% for this task
- Acceptance criteria met: All checkboxes checked with evidence links
- Task deliverables: All promised outputs exist and functional

**Documentation Evidence:**
- Post-mortem created: `##-TASK-POSTMORTEM.md` exists with gaps/lessons
- Corrective actions: All gaps → immediate fixes OR new task docs
- Status updated: PROJECT-STATUS.md reflects current reality

**Git Evidence:**
- Commit message: Conventional commit format `type(scope): description`
- Working tree clean: `git status` shows no uncommitted changes

### Progressive Validation Pattern

**After EVERY task completion, run validation checklist:**

1. **TODO Scan**: `grep -r "TODO\|FIXME" <package>` - zero new TODOs vs baseline
2. **Test Run**: `runTests ./path/to/package` - all tests passing
3. **Coverage Check**: `go test -cover` - coverage maintained/improved
4. **Requirements**: Validation tool shows maintained/improved coverage
5. **Integration**: Core E2E flow still works
6. **Documentation**: PROJECT-STATUS.md updated with metrics

**Quality Gate**: Task NOT complete until all 6 checks pass

### Single Source of Truth Pattern

**PROJECT-STATUS.md is ONLY authoritative source for status**

**Mandatory Sections:**
- Current Status: ❌ NOT READY | ⚠️ CONDITIONAL | ✅ PRODUCTION READY
- Completion Metrics: X/Y tasks, Z% requirements, W TODOs
- Known Limitations: Documented gaps with task/issue references
- Production Blockers: Critical gaps preventing deployment
- Last Updated: Timestamp, commit hash

**All other docs REFERENCE the single source of truth:**
- MASTER-PLAN.md: "See PROJECT-STATUS.md for current status"
- README.md: "See PROJECT-STATUS.md for completion metrics"

**Update Triggers:**
- After every task completion (via manage_todo_list)
- After requirements validation run
- After TODO scan
- Before any "production ready" claim

### Foundation-Before-Features Enforcement

**MUST complete phases in strict sequence:**

**Phase 1: Foundation** (REQUIRED before Phase 2)
- Domain models, database schema, repository CRUD
- Exit: All CRUD works, ≥85% coverage, zero TODOs, integration tests pass

**Phase 2: Core Features** (REQUIRED before Phase 3)
- Business logic, API endpoints, auth/authz flows
- Exit: Core flows work E2E, API functional, zero CRITICAL/HIGH TODOs

**Phase 3: Advanced Features** (ONLY after Phase 1+2 complete)
- MFA, WebAuthn, hardware credentials, adaptive auth
- Exit: Advanced features integrate with solid foundation

**Dependency Checks in Acceptance Criteria:**
- All Phase 1 complete (if Phase 2 task)
- All Phase 2 complete (if Phase 3 task)

### Post-Mortem Enforcement

**For EVERY gap identified in post-mortem:**

**Immediate Fixes** (applied in current task):
- Fix documented in "Immediate Corrective Actions"
- Test added to prevent regression
- Acceptance criteria updated if new pattern

**Deferred Fixes** (future work):
- MUST create new task document: `##.##-GAP_NAME.md`
- MUST add to manage_todo_list with clear acceptance
- MUST add to dependency graph (update MASTER-PLAN)

**Pattern Improvements** (affect future tasks):
- Pattern documented in LESSONS-LEARNED.md
- Template/instructions updated
- Code review checklist updated

**Validation**: Task NOT complete until all gaps → fixes OR new tasks

### Requirements Coverage Threshold

**Per-Task Threshold:** ≥90% of assigned requirements validated
**Overall Threshold:** ≥85% overall requirements coverage

**Enforcement:**
```bash
# Per-task check
coverage=$(requirements-check --task R01 --format json | jq '.coverage_percentage')
if (( $(echo "$coverage < 90" | bc -l) )); then
  echo "ERROR: Coverage $coverage% < 90% threshold"
  exit 1
fi
```

**Acceptance Criteria Addition:**
- Requirements coverage ≥90% for this task (automated check)
- Overall coverage maintained ≥85% (no regression)
- Uncovered requirements documented with justification

### Common Violations to Avoid

**❌ NEVER:**
- Mark task "complete" without running validation commands
- Claim "100% done" when TODO scan shows HIGH priority items
- Skip post-mortem creation
- Leave gaps undocumented or without follow-up tasks
- Implement Phase 3 features before Phase 2 works
- Update multiple status docs instead of PROJECT-STATUS.md single source

**✅ ALWAYS:**
- Run all 6 progressive validation checks
- Create post-mortem with gaps analysis
- Convert all gaps to immediate fixes OR new tasks
- Update PROJECT-STATUS.md as single source of truth
- Respect phase dependencies (Foundation → Core → Advanced)
- Provide evidence links for acceptance criteria
