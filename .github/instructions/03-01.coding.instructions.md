---
description: "Instructions for coding patterns and standards"
applyTo: "**"
---
# Coding

## File Size Limits

**Soft limit**: 300 lines (ideal target)
**Medium limit**: 400 lines (acceptable with justification)
**Hard limit**: 500 lines -> refactor required

## Code Patterns

### Default Values

**ALWAYS declare default values as named variables** rather than inline literals.

```go
var defaultPort = 8080
server.Start(defaultPort)  // CORRECT
server.Start(8080)         // WRONG
```

### Pass-through Calls

**Prefer same parameter and return value order** as helper functions.

### Context Reading Before Refactoring - CRITICAL

**ALWAYS read complete package context before refactoring** (NEVER refactor in isolation).

**Key Questions**: Why does this code exist? What protections are in place? Are "verbose" comments intentional? What tests validate this behavior?

### Conditional Statement Chaining

**PREFER SWITCH STATEMENTS** over `if/else if/else` chains:

```go
switch {
case ctx == nil:
    return nil, fmt.Errorf("nil context")
case logger == nil:
    return nil, fmt.Errorf("nil logger")
default:
    return processValid(ctx, logger, description)
}
```

**ALWAYS chain if/else if/else** for mutually exclusive conditions (not separate if statements).

## Format_go Self-Modification Protection - CRITICAL

**MANDATORY Prevention Rules**:
- NEVER change ` +""+interface{}+""+ ` to ` +""+ny+""+ ` in format_go package
- NEVER simplify CRITICAL/SELF-MODIFICATION comments
- ALWAYS read complete package context (enforce_any.go, filter.go, magic_cicd.go, format_go_test.go, self_modification_test.go) before modifying
