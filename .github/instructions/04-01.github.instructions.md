---
description: "Instructions for CI/CD workflow configuration, service connectivity verification, and diagnostic logging"
applyTo: "**"
---
# CI/CD Workflow Instructions - Tactical Guidance

**Reference**: See `.specify/memory/github.md` for complete specifications (workflow matrix, PostgreSQL patterns, artifact management, gh CLI commands, variable expansion lessons)

**This file contains ONLY tactical implementation patterns**

## PostgreSQL Service Patterns

**Unit/Integration Tests** (Recommended):

```go
container, _ := postgres.RunContainer(ctx,
    postgres.WithDatabase(fmt.Sprintf("test_%s", googleUuid.NewV7().String())),
    postgres.WithUsername(fmt.Sprintf("user_%s", googleUuid.NewV7().String())),
)
```

**E2E Tests** (Production-like):

```yaml
app:
  secrets:
    - database_url
  command: ["--database-url=file:///run/secrets/database_url"]
```

## Workflow Matrix

**ci-quality**: Linting, formatting, build | **ci-coverage/mutation/race**: Test analysis | **ci-sast/dast**: Security scanning | **ci-e2e/benchmark/load**: Integration/performance

## Variable Expansion in Heredocs - CRITICAL

```yaml
- name: Generate config
  run: |
    cat > config.yml <<EOF
    database-url: "postgres://${POSTGRES_USER}:${POSTGRES_PASS}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_NAME}"
    EOF
```

**ALWAYS use `${VAR}` (curly braces), NEVER `$VAR`**

## GitHub CLI for Workflow Diagnostics

```bash
# List recent workflow runs
gh run list --limit 10

# View failed workflow logs
gh run view <run-id> --log-failed

# Download workflow artifacts
gh run download <run-id>

# Re-run failed jobs
gh run rerun <run-id> --failed
```
