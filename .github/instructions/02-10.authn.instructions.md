---
description: "Authentication and authorization tactical implementation patterns"
applyTo: "**"
---
# Authentication and Authorization - Tactical Guidance

**Reference**: See `.specify/memory/authn-authz-factors.md` for complete specifications (10 headless + 28 browser authentication methods, storage realms, MFA combinations, authorization methods)

**This file contains ONLY tactical implementation patterns**

### Zero Trust Authorization Pattern

**MANDATORY: NO caching of authorization decisions**

### MFA Step-Up Pattern

**30-Minute Re-Authentication**:

### Testing Pattern

**Comprehensive Factor Testing**:

Test all 10 headless + 28 browser methods for comprehensive coverage, and parallel for robustness.

---

## Common Pitfalls

❌ Cache authz decisions, use Redis/Memcached for sessions, skip MFA step-up, assume realm availability
✅ Re-evaluate authz every request, use PostgreSQL/SQLite (ACID), enforce 30min MFA step-up, implement realm failover

---
