---
description: "Instructions for database operations and ORM patterns"
applyTo: "**"
---
# Database and ORM Instructions

- Use [GORM ORM](https://gorm.io/) (never sql.DB directly)
- Use transactions, error mapping, migrations, pooling, pagination, filters, UUIDv7 PKs, FKs, debug logging as needed
- Implement proper error mapping from GORM errors to application HTTP errors in `toAppErr` methods
- Use embedded SQL migrations with golang-migrate for schema changes
- Support both PostgreSQL (production) and SQLite (development/testing) backends
- Always apply database migrations on startup
- Use proper pagination with offset/limit patterns for large result sets
- Log database schema information in debug mode for troubleshooting

## Database DSN Usage

**Database DSN (Use localhost):**
```go
dsn := "postgres://user:pass@localhost:5432/dbname?sslmode=disable"
```
