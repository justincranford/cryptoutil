---
description: "Local Git commands and commit conventions"
applyTo: "**"
---
# Git

## Conventional Commits Format

**Format**: `<type>[optional scope]: <description>`

**Types**: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert

**Examples**:

```bash
feat(auth): add OAuth2 client credentials flow
fix(database): prevent connection pool exhaustion
feat(api)!: remove deprecated v1 endpoints  # Breaking change
```

## Incremental Commits - CRITICAL

- ALWAYS commit incrementally (NOT amend) - preserves history for bisect, selective revert.
- NEVER repeatedly amend - loses context, hard to bisect.
- Amend ONLY for immediate typo fixes (<1 min, before push).

## Restore from Clean Baseline Pattern

**When fixing regressions, ALWAYS restore clean baseline FIRST**:

1. Find last known-good commit (`git log --oneline --grep="baseline"`)
2. Restore package (`git checkout <hash> -- path/to/package/`)
3. Verify baseline works (`go test`)
4. Apply ONLY the new fix (minimal change)
5. Commit as NEW commit (NOT amend)

**Why**: HEAD may be corrupted from previous failed attempts. Start from known-good state.

## Session Documentation Strategy

**NEVER create standalone session docs**: `docs/SESSION-*.md`, `docs/analysis-*.md`

## Git Workflow

**Terminal Commands**: git status, add -A, commit -m, push, log, diff, checkout, mv
**Commit vs Push**: Commit frequently (atomic changes), push strategically (CI/CD ready)
**Pre-Push**: ALWAYS run tests, linting before pushing/PR

## Pull Request Descriptions

**Title**: `type(scope): description` (<72 chars)
**Sections**: What, Why, How, Testing, Breaking Changes
**PR Size**: <200 (small), 200-500 (medium), 500+ (split), 1000+ (break down)

## PowerShell Notes

- Chain commands with `;` (NOT `&&`)
- Use `Get-Content file | Select-String 'pattern'` for grep-like searches
