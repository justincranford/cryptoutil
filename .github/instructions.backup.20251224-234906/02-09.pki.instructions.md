---
description: "Instructions for PKI, CA, certificate management, and CA/Browser Forum compliance"
applyTo: "**"
---
# PKI and Certificate Management - Tactical Guidance

**Reference**: See `.specify/memory/pki.md` for complete specifications (CA/Browser Forum Baseline Requirements, certificate profiles, CA architecture, key ceremonies, CT, OCSP, CAA)

**This file contains ONLY tactical implementation patterns**

## Quick Reference: Certificate Validation

```go
// ✅ CORRECT: Strict TLS configuration
tlsConfig := &tls.Config{
    MinVersion:         tls.VersionTLS13,
    InsecureSkipVerify: false,  // ALWAYS validate certs
    RootCAs:            certPool,
    ClientCAs:          certPool,
    ClientAuth:         tls.RequireAndVerifyClientCert,
}
```

## CA Architecture

3-tier (Offline→Online→Issuing): Max security | 2-tier (Online→Issuing): Balanced | 1-tier: Dev/test only

## Certificate Compliance Checklist

**Subscriber Certificates**:

- ✅ Serial ≥64 bits CSPRNG, >0, <2^159
- ✅ RSA ≥2048, ECDSA P-256/384/521, EdDSA
- ✅ SHA-256/384/512 (NEVER MD5/SHA-1)
- ✅ Validity ≤398 days
- ✅ Extensions: Key Usage (critical), EKU, SAN, AKI, SKI
- ✅ CRL/OCSP URIs present
- ✅ Audit logs 7 years

**Validation**:

- ✅ DV: Within 30 days
- ✅ OV/EV: Within 13 months
- ✅ CAA checked before issuance
