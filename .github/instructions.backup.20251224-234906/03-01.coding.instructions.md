---
description: "Instructions for coding patterns and standards"
applyTo: "**"
---
# Coding Instructions

**Reference**: See `.specify/memory/coding.md` for complete specifications (file size limits, refactoring rules, self-modification protection)

**This file contains ONLY tactical patterns**

## File Size Limits

- Soft: 300 lines
- Medium: 400 lines
- Hard: 500 lines → refactor required

## Code Patterns

### Default Values

- **ALWAYS declare default values as named variables** rather than inline literals
- Example: `var defaultConfigFiles = []string{}`

### Pass-through Calls

- **Prefer same parameter and return value order** as helper functions
- Maintains API consistency and reduces confusion

### Context Reading Before Refactoring - CRITICAL

**ALWAYS read complete package context before refactoring** (README, post-mortems, git log, test files, self-exclusion patterns)
**Never refactor in isolation** → understand WHY code exists, WHAT protections are in place, WHAT tests validate behavior

### Format_go Protection - CRITICAL

**ALWAYS read complete package context before refactoring self-modifying code** (enforce_any.go, filter.go, magic_cicd.go, format_go_test.go, self_modification_test.go)
❌ NEVER change `` `interface{}` `` to `` `any` `` in format_go package
❌ NEVER simplify CRITICAL/SELF-MODIFICATION comments

## Conditional Statement Chaining

### CRITICAL: Pattern for Mutually Exclusive Conditions

**PREFER SWITCH STATEMENTS** over `if/else if/else` chains for cleaner, more maintainable code

## ALWAYS prefer Switch Statements

- **ALWAYS prefer switch statements** over `if/else if/else` chains when possible
- When switch not possible, prefer `if/else if/else` over separate `if` statements

**ALWAYS prefer chained if/else if/else for mutually exclusive conditions:**

```go
if ctx == nil {
    return nil, fmt.Errorf("nil context")
} else if logger == nil {
    return nil, fmt.Errorf("nil logger")
} else if description == "" {
    return nil, fmt.Errorf("empty description")
}
```

**Avoid separate if statements for mutually exclusive conditions:**

```go
// DON'T DO THIS for mutually exclusive conditions
if ctx == nil {
    return nil, fmt.Errorf("nil context")
}
if logger == nil {
    return nil, fmt.Errorf("nil logger")
}
```

### When NOT to Chain

- Independent conditions (not mutually exclusive)
- Error accumulation patterns
- Cases with early returns that don't overlap
