# SSH User Certificate Profile
# For SSH user authentication certificates.
# Compatible with OpenSSH certificate format requirements.

profile:
  name: "ssh-user"
  description: "SSH User Authentication Certificate"

  validity:
    max_days: 30
    min_days: 0
    default_days: 1

  key:
    allowed_algorithms:
      - algorithm: "RSA"
        min_size: 2048
        max_size: 4096
      - algorithm: "ECDSA"
        allowed_curves:
          - "P-256"
          - "P-384"
      - algorithm: "Ed25519"
    default_algorithm: "Ed25519"
    default_curve_or_size: null

  key_usage:
    - "digitalSignature"

  extended_key_usage:
    required:
      - "clientAuth"
    optional: []

  subject:
    require_common_name: true
    allow_organization: false
    allow_organizational_unit: false
    allow_country: false
    allow_state: false
    allow_locality: false
    max_cn_length: 64

  san:
    allow_dns_names: false
    allow_ip_addresses: false
    allow_email_addresses: true
    allow_uris: false
    require_at_least_one: false
    max_entries: 5

  extensions:
    required:
      - "subjectKeyIdentifier"
      - "authorityKeyIdentifier"
      - "keyUsage"
      - "basicConstraints"
    optional: []

  # SSH-specific principals (usernames)
  ssh:
    allow_principals: true
    max_principals: 10
